<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.7.31">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>fft</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==" crossorigin="anonymous"></script><script src="fft_files/libs/clipboard/clipboard.min.js"></script>
<script src="fft_files/libs/quarto-html/quarto.js" type="module"></script>
<script src="fft_files/libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="fft_files/libs/quarto-html/popper.min.js"></script>
<script src="fft_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="fft_files/libs/quarto-html/anchor.min.js"></script>
<link href="fft_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="fft_files/libs/quarto-html/quarto-syntax-highlighting-e1a5c8363afafaef2c763b6775fbf3ca.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="fft_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="fft_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="fft_files/libs/bootstrap/bootstrap-1bda18309b16c177077761a3cdd06e53.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" integrity="sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==" crossorigin="anonymous"></script>

<script type="application/javascript">define('jquery', [],function() {return window.jQuery;})</script>


</head>

<body class="fullcontent quarto-light">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">

<main class="content" id="quarto-document-content">




<div id="cell-0" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="im">using</span> <span class="bu">FFTW</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="im">using</span> <span class="bu">BenchmarkTools</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="cell-1" class="cell" data-execution_count="2">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="fu">fft_1dgpt</span>(x<span class="op">::</span><span class="dt">AbstractVector{Complex{T}}</span>) <span class="kw">where</span> T<span class="op">&lt;:</span><span class="dt">AbstractFloat</span></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>    N <span class="op">=</span> <span class="fu">length</span>(x)</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>    <span class="pp">@assert</span> <span class="fu">ispow2</span>(N) <span class="st">"Length must be a power of 2"</span></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Make a working copy</span></span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>    y <span class="op">=</span> <span class="fu">copy</span>(x)</span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>    <span class="co"># 1) Bit‑reversal permutation</span></span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a>    bits <span class="op">=</span> <span class="fu">Int</span>(<span class="fu">floor</span>(<span class="fu">log2</span>(N)))</span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="fl">0</span><span class="op">:</span>(N<span class="op">-</span><span class="fl">1</span>)</span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a>        j <span class="op">=</span> <span class="fu">bitreverse</span>(i) <span class="op">&gt;&gt;&gt;</span> (<span class="fu">sizeof</span>(<span class="dt">Int</span>)<span class="op">*</span><span class="fl">8</span> <span class="op">-</span> bits)</span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> j <span class="op">&gt;</span> i</span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a>            y[i<span class="op">+</span><span class="fl">1</span>], y[j<span class="op">+</span><span class="fl">1</span>] <span class="op">=</span> y[j<span class="op">+</span><span class="fl">1</span>], y[i<span class="op">+</span><span class="fl">1</span>]</span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a>        <span class="cf">end</span></span>
<span id="cb2-15"><a href="#cb2-15" aria-hidden="true" tabindex="-1"></a>    <span class="cf">end</span></span>
<span id="cb2-16"><a href="#cb2-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-17"><a href="#cb2-17" aria-hidden="true" tabindex="-1"></a>    <span class="co"># 2) Cooley‑Tuk decimation‑in‑place</span></span>
<span id="cb2-18"><a href="#cb2-18" aria-hidden="true" tabindex="-1"></a>    m <span class="op">=</span> <span class="fl">1</span></span>
<span id="cb2-19"><a href="#cb2-19" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> m <span class="op">&lt;</span> N</span>
<span id="cb2-20"><a href="#cb2-20" aria-hidden="true" tabindex="-1"></a>        half <span class="op">=</span> m</span>
<span id="cb2-21"><a href="#cb2-21" aria-hidden="true" tabindex="-1"></a>        m <span class="op">*=</span> <span class="fl">2</span></span>
<span id="cb2-22"><a href="#cb2-22" aria-hidden="true" tabindex="-1"></a>        <span class="co"># principal m‑th root of unity: exp(-2πi/m)</span></span>
<span id="cb2-23"><a href="#cb2-23" aria-hidden="true" tabindex="-1"></a>        wm <span class="op">=</span> <span class="fu">cis</span>(<span class="op">-</span><span class="fl">2</span>π<span class="op">/</span>m)</span>
<span id="cb2-24"><a href="#cb2-24" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> k <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span>m<span class="op">:</span>N</span>
<span id="cb2-25"><a href="#cb2-25" aria-hidden="true" tabindex="-1"></a>            w <span class="op">=</span> <span class="fu">one</span>(wm)</span>
<span id="cb2-26"><a href="#cb2-26" aria-hidden="true" tabindex="-1"></a>            <span class="cf">for</span> j <span class="kw">in</span> <span class="fl">0</span><span class="op">:</span>(half<span class="op">-</span><span class="fl">1</span>)</span>
<span id="cb2-27"><a href="#cb2-27" aria-hidden="true" tabindex="-1"></a>                u <span class="op">=</span> y[k <span class="op">+</span> j]</span>
<span id="cb2-28"><a href="#cb2-28" aria-hidden="true" tabindex="-1"></a>                t <span class="op">=</span> w <span class="op">*</span> y[k <span class="op">+</span> j <span class="op">+</span> half]</span>
<span id="cb2-29"><a href="#cb2-29" aria-hidden="true" tabindex="-1"></a>                y[k <span class="op">+</span> j]          <span class="op">=</span> u <span class="op">+</span> t</span>
<span id="cb2-30"><a href="#cb2-30" aria-hidden="true" tabindex="-1"></a>                y[k <span class="op">+</span> j <span class="op">+</span> half]   <span class="op">=</span> u <span class="op">-</span> t</span>
<span id="cb2-31"><a href="#cb2-31" aria-hidden="true" tabindex="-1"></a>                w <span class="op">*=</span> wm</span>
<span id="cb2-32"><a href="#cb2-32" aria-hidden="true" tabindex="-1"></a>            <span class="cf">end</span></span>
<span id="cb2-33"><a href="#cb2-33" aria-hidden="true" tabindex="-1"></a>        <span class="cf">end</span></span>
<span id="cb2-34"><a href="#cb2-34" aria-hidden="true" tabindex="-1"></a>    <span class="cf">end</span></span>
<span id="cb2-35"><a href="#cb2-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-36"><a href="#cb2-36" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> y</span>
<span id="cb2-37"><a href="#cb2-37" aria-hidden="true" tabindex="-1"></a><span class="kw">end</span></span>
<span id="cb2-38"><a href="#cb2-38" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="fu">fft_1dgpt</span>(x<span class="op">::</span><span class="dt">AbstractVector{T}</span>) <span class="kw">where</span> T<span class="op">&lt;:</span><span class="dt">AbstractFloat</span></span>
<span id="cb2-39"><a href="#cb2-39" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="fu">fft_1dgpt</span>(<span class="fu">complex</span>.(x))</span>
<span id="cb2-40"><a href="#cb2-40" aria-hidden="true" tabindex="-1"></a><span class="kw">end</span></span>
<span id="cb2-41"><a href="#cb2-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-42"><a href="#cb2-42" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="fu">fft_1dgpt</span>(x) </span>
<span id="cb2-43"><a href="#cb2-43" aria-hidden="true" tabindex="-1"></a>    N <span class="op">=</span> <span class="fu">length</span>(x)</span>
<span id="cb2-44"><a href="#cb2-44" aria-hidden="true" tabindex="-1"></a>    <span class="pp">@assert</span> <span class="fu">ispow2</span>(N) <span class="st">"Length must be a power of 2"</span></span>
<span id="cb2-45"><a href="#cb2-45" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Make a working copy</span></span>
<span id="cb2-46"><a href="#cb2-46" aria-hidden="true" tabindex="-1"></a>    y <span class="op">=</span> <span class="fu">copy</span>(x)</span>
<span id="cb2-47"><a href="#cb2-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-48"><a href="#cb2-48" aria-hidden="true" tabindex="-1"></a>    <span class="co"># 1) Bit‑reversal permutation</span></span>
<span id="cb2-49"><a href="#cb2-49" aria-hidden="true" tabindex="-1"></a>    bits <span class="op">=</span> <span class="fu">Int</span>(<span class="fu">floor</span>(<span class="fu">log2</span>(N)))</span>
<span id="cb2-50"><a href="#cb2-50" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="fl">0</span><span class="op">:</span>(N<span class="op">-</span><span class="fl">1</span>)</span>
<span id="cb2-51"><a href="#cb2-51" aria-hidden="true" tabindex="-1"></a>        j <span class="op">=</span> <span class="fu">bitreverse</span>(i) <span class="op">&gt;&gt;&gt;</span> (<span class="fu">sizeof</span>(<span class="dt">Int</span>)<span class="op">*</span><span class="fl">8</span> <span class="op">-</span> bits)</span>
<span id="cb2-52"><a href="#cb2-52" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> j <span class="op">&gt;</span> i</span>
<span id="cb2-53"><a href="#cb2-53" aria-hidden="true" tabindex="-1"></a>            y[i<span class="op">+</span><span class="fl">1</span>], y[j<span class="op">+</span><span class="fl">1</span>] <span class="op">=</span> y[j<span class="op">+</span><span class="fl">1</span>], y[i<span class="op">+</span><span class="fl">1</span>]</span>
<span id="cb2-54"><a href="#cb2-54" aria-hidden="true" tabindex="-1"></a>        <span class="cf">end</span></span>
<span id="cb2-55"><a href="#cb2-55" aria-hidden="true" tabindex="-1"></a>    <span class="cf">end</span></span>
<span id="cb2-56"><a href="#cb2-56" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-57"><a href="#cb2-57" aria-hidden="true" tabindex="-1"></a>    <span class="co"># 2) Cooley‑Tuk decimation‑in‑place</span></span>
<span id="cb2-58"><a href="#cb2-58" aria-hidden="true" tabindex="-1"></a>    m <span class="op">=</span> <span class="fl">1</span></span>
<span id="cb2-59"><a href="#cb2-59" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> m <span class="op">&lt;</span> N</span>
<span id="cb2-60"><a href="#cb2-60" aria-hidden="true" tabindex="-1"></a>        half <span class="op">=</span> m</span>
<span id="cb2-61"><a href="#cb2-61" aria-hidden="true" tabindex="-1"></a>        m <span class="op">*=</span> <span class="fl">2</span></span>
<span id="cb2-62"><a href="#cb2-62" aria-hidden="true" tabindex="-1"></a>        <span class="co"># principal m‑th root of unity: exp(-2πi/m)</span></span>
<span id="cb2-63"><a href="#cb2-63" aria-hidden="true" tabindex="-1"></a>        wm <span class="op">=</span> <span class="fu">cis</span>(<span class="op">-</span><span class="fl">2</span>π<span class="op">/</span>m)</span>
<span id="cb2-64"><a href="#cb2-64" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> k <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span>m<span class="op">:</span>N</span>
<span id="cb2-65"><a href="#cb2-65" aria-hidden="true" tabindex="-1"></a>            w <span class="op">=</span> <span class="fu">one</span>(wm)</span>
<span id="cb2-66"><a href="#cb2-66" aria-hidden="true" tabindex="-1"></a>            <span class="cf">for</span> j <span class="kw">in</span> <span class="fl">0</span><span class="op">:</span>(half<span class="op">-</span><span class="fl">1</span>)</span>
<span id="cb2-67"><a href="#cb2-67" aria-hidden="true" tabindex="-1"></a>                u <span class="op">=</span> y[k <span class="op">+</span> j]</span>
<span id="cb2-68"><a href="#cb2-68" aria-hidden="true" tabindex="-1"></a>                t <span class="op">=</span> w <span class="op">*</span> y[k <span class="op">+</span> j <span class="op">+</span> half]</span>
<span id="cb2-69"><a href="#cb2-69" aria-hidden="true" tabindex="-1"></a>                y[k <span class="op">+</span> j]          <span class="op">=</span> u <span class="op">+</span> t</span>
<span id="cb2-70"><a href="#cb2-70" aria-hidden="true" tabindex="-1"></a>                y[k <span class="op">+</span> j <span class="op">+</span> half]   <span class="op">=</span> u <span class="op">-</span> t</span>
<span id="cb2-71"><a href="#cb2-71" aria-hidden="true" tabindex="-1"></a>                w <span class="op">*=</span> wm</span>
<span id="cb2-72"><a href="#cb2-72" aria-hidden="true" tabindex="-1"></a>            <span class="cf">end</span></span>
<span id="cb2-73"><a href="#cb2-73" aria-hidden="true" tabindex="-1"></a>        <span class="cf">end</span></span>
<span id="cb2-74"><a href="#cb2-74" aria-hidden="true" tabindex="-1"></a>    <span class="cf">end</span></span>
<span id="cb2-75"><a href="#cb2-75" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-76"><a href="#cb2-76" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> y</span>
<span id="cb2-77"><a href="#cb2-77" aria-hidden="true" tabindex="-1"></a><span class="kw">end</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>fft_1dgpt (generic function with 3 methods)</code></pre>
</div>
</div>
<div id="cell-2" class="cell" data-execution_count="21">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a><span class="st">    fft_1dgpt_real!(x_re, x_im)</span></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a><span class="st">In-place FFT on two real-valued vectors `x_re`, `x_im`.</span></span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a><span class="st">Both must be the same length `N` (a power of two).</span></span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a><span class="st">The input in `x_im` is usually all zeros (for real input).</span></span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a><span class="st">After this call, `x_re` and `x_im` hold the real and imaginary parts</span></span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a><span class="st">of the FFT, suitable for use in JuMP @NLobjective.</span></span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="fu">fft_1dgpt!</span>(x_re<span class="op">::</span><span class="dt">AbstractVector{T}</span>, x_im<span class="op">::</span><span class="dt">AbstractVector{T}</span>) <span class="kw">where</span> {T<span class="op">&lt;:</span><span class="dt">AbstractFloat</span>}</span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a>    N <span class="op">=</span> <span class="fu">length</span>(x_re)</span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true" tabindex="-1"></a>    <span class="pp">@assert</span> N <span class="op">==</span> <span class="fu">length</span>(x_im) <span class="st">"re/im must match length"</span></span>
<span id="cb4-13"><a href="#cb4-13" aria-hidden="true" tabindex="-1"></a>    <span class="pp">@assert</span> <span class="fu">ispow2</span>(N) <span class="st">"Length must be a power of two"</span></span>
<span id="cb4-14"><a href="#cb4-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-15"><a href="#cb4-15" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Bit‑reversal on both real &amp; imag</span></span>
<span id="cb4-16"><a href="#cb4-16" aria-hidden="true" tabindex="-1"></a>    bits <span class="op">=</span> <span class="fu">Int</span>(<span class="fu">floor</span>(<span class="fu">log2</span>(N)))</span>
<span id="cb4-17"><a href="#cb4-17" aria-hidden="true" tabindex="-1"></a>    <span class="pp">@inbounds</span> <span class="cf">for</span> i <span class="kw">in</span> <span class="fl">0</span><span class="op">:</span>N<span class="op">-</span><span class="fl">1</span></span>
<span id="cb4-18"><a href="#cb4-18" aria-hidden="true" tabindex="-1"></a>        j <span class="op">=</span> <span class="fu">bitreverse</span>(i) <span class="op">&gt;&gt;&gt;</span> (<span class="fu">sizeof</span>(<span class="dt">Int</span>)<span class="op">*</span><span class="fl">8</span> <span class="op">-</span> bits)</span>
<span id="cb4-19"><a href="#cb4-19" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> j <span class="op">&gt;</span> i</span>
<span id="cb4-20"><a href="#cb4-20" aria-hidden="true" tabindex="-1"></a>            x_re[i<span class="op">+</span><span class="fl">1</span>], x_re[j<span class="op">+</span><span class="fl">1</span>] <span class="op">=</span> x_re[j<span class="op">+</span><span class="fl">1</span>], x_re[i<span class="op">+</span><span class="fl">1</span>]</span>
<span id="cb4-21"><a href="#cb4-21" aria-hidden="true" tabindex="-1"></a>            x_im[i<span class="op">+</span><span class="fl">1</span>], x_im[j<span class="op">+</span><span class="fl">1</span>] <span class="op">=</span> x_im[j<span class="op">+</span><span class="fl">1</span>], x_im[i<span class="op">+</span><span class="fl">1</span>]</span>
<span id="cb4-22"><a href="#cb4-22" aria-hidden="true" tabindex="-1"></a>        <span class="cf">end</span></span>
<span id="cb4-23"><a href="#cb4-23" aria-hidden="true" tabindex="-1"></a>    <span class="cf">end</span></span>
<span id="cb4-24"><a href="#cb4-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-25"><a href="#cb4-25" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Cooley‑Tuk stages</span></span>
<span id="cb4-26"><a href="#cb4-26" aria-hidden="true" tabindex="-1"></a>    m <span class="op">=</span> <span class="fl">1</span></span>
<span id="cb4-27"><a href="#cb4-27" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> m <span class="op">&lt;</span> N</span>
<span id="cb4-28"><a href="#cb4-28" aria-hidden="true" tabindex="-1"></a>        half <span class="op">=</span> m</span>
<span id="cb4-29"><a href="#cb4-29" aria-hidden="true" tabindex="-1"></a>        m <span class="op">*=</span> <span class="fl">2</span></span>
<span id="cb4-30"><a href="#cb4-30" aria-hidden="true" tabindex="-1"></a>        θ <span class="op">=</span> <span class="op">-</span><span class="fl">2</span>π <span class="op">/</span> m</span>
<span id="cb4-31"><a href="#cb4-31" aria-hidden="true" tabindex="-1"></a>        <span class="pp">@inbounds</span> <span class="cf">for</span> j <span class="kw">in</span> <span class="fl">0</span><span class="op">:</span>half<span class="op">-</span><span class="fl">1</span></span>
<span id="cb4-32"><a href="#cb4-32" aria-hidden="true" tabindex="-1"></a>            c <span class="op">=</span> <span class="fu">cos</span>(θ<span class="op">*</span>j)     <span class="co"># real constant :contentReference[oaicite:8]{index=8}</span></span>
<span id="cb4-33"><a href="#cb4-33" aria-hidden="true" tabindex="-1"></a>            s <span class="op">=</span> <span class="fu">sin</span>(θ<span class="op">*</span>j)</span>
<span id="cb4-34"><a href="#cb4-34" aria-hidden="true" tabindex="-1"></a>            <span class="cf">for</span> k <span class="kw">in</span> j<span class="op">:</span>m<span class="op">:</span>N<span class="op">-</span><span class="fl">1</span></span>
<span id="cb4-35"><a href="#cb4-35" aria-hidden="true" tabindex="-1"></a>                u <span class="op">=</span> k <span class="op">+</span> <span class="fl">1</span></span>
<span id="cb4-36"><a href="#cb4-36" aria-hidden="true" tabindex="-1"></a>                v <span class="op">=</span> k <span class="op">+</span> half <span class="op">+</span> <span class="fl">1</span></span>
<span id="cb4-37"><a href="#cb4-37" aria-hidden="true" tabindex="-1"></a>                u_re, u_im <span class="op">=</span> x_re[u], x_im[u]</span>
<span id="cb4-38"><a href="#cb4-38" aria-hidden="true" tabindex="-1"></a>                v_re, v_im <span class="op">=</span> x_re[v], x_im[v]</span>
<span id="cb4-39"><a href="#cb4-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-40"><a href="#cb4-40" aria-hidden="true" tabindex="-1"></a>                <span class="co"># complex multiply (v * cis(θ*j)) in real form</span></span>
<span id="cb4-41"><a href="#cb4-41" aria-hidden="true" tabindex="-1"></a>                t_re <span class="op">=</span>  c<span class="op">*</span>v_re <span class="op">-</span> s<span class="op">*</span>v_im</span>
<span id="cb4-42"><a href="#cb4-42" aria-hidden="true" tabindex="-1"></a>                t_im <span class="op">=</span>  s<span class="op">*</span>v_re <span class="op">+</span> c<span class="op">*</span>v_im</span>
<span id="cb4-43"><a href="#cb4-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-44"><a href="#cb4-44" aria-hidden="true" tabindex="-1"></a>                <span class="co"># butterfly</span></span>
<span id="cb4-45"><a href="#cb4-45" aria-hidden="true" tabindex="-1"></a>                x_re[u] <span class="op">=</span> u_re <span class="op">+</span> t_re</span>
<span id="cb4-46"><a href="#cb4-46" aria-hidden="true" tabindex="-1"></a>                x_im[u] <span class="op">=</span> u_im <span class="op">+</span> t_im</span>
<span id="cb4-47"><a href="#cb4-47" aria-hidden="true" tabindex="-1"></a>                x_re[v] <span class="op">=</span> u_re <span class="op">-</span> t_re</span>
<span id="cb4-48"><a href="#cb4-48" aria-hidden="true" tabindex="-1"></a>                x_im[v] <span class="op">=</span> u_im <span class="op">-</span> t_im</span>
<span id="cb4-49"><a href="#cb4-49" aria-hidden="true" tabindex="-1"></a>            <span class="cf">end</span></span>
<span id="cb4-50"><a href="#cb4-50" aria-hidden="true" tabindex="-1"></a>        <span class="cf">end</span></span>
<span id="cb4-51"><a href="#cb4-51" aria-hidden="true" tabindex="-1"></a>    <span class="cf">end</span></span>
<span id="cb4-52"><a href="#cb4-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-53"><a href="#cb4-53" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="cn">nothing</span></span>
<span id="cb4-54"><a href="#cb4-54" aria-hidden="true" tabindex="-1"></a><span class="kw">end</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>fft_1dgpt!</code></pre>
</div>
</div>
<div id="cell-4" class="cell" data-execution_count="4">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="fu">fft_2dcustom</span>(A<span class="op">::</span><span class="dt">AbstractMatrix{Complex{T}}</span>) <span class="kw">where</span> T<span class="op">&lt;:</span><span class="dt">AbstractFloat</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>    Ny, Nx <span class="op">=</span> <span class="fu">size</span>(A)</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>    <span class="pp">@assert</span> <span class="fu">ispow2</span>(Ny) <span class="op">&amp;&amp;</span> <span class="fu">ispow2</span>(Nx) <span class="st">"Both dimensions must be powers of 2"</span></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>    B <span class="op">=</span> <span class="fu">similar</span>(A)</span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>    <span class="co"># 1) FFT down each column</span></span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a>    <span class="pp">@inbounds</span> <span class="pp">@simd</span> <span class="cf">for</span> x <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span>Nx</span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a>        B[<span class="op">:</span>, x] <span class="op">=</span> <span class="fu">fft_1dgpt</span>(<span class="fu">view</span>(A, <span class="op">:</span>, x))</span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a>    <span class="cf">end</span></span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a>    <span class="co"># 2) FFT across each row of the intermediate result</span></span>
<span id="cb6-12"><a href="#cb6-12" aria-hidden="true" tabindex="-1"></a>    <span class="pp">@inbounds</span> <span class="pp">@simd</span> <span class="cf">for</span> y <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span>Ny</span>
<span id="cb6-13"><a href="#cb6-13" aria-hidden="true" tabindex="-1"></a>        B[y, <span class="op">:</span>] <span class="op">=</span> <span class="fu">fft_1dgpt</span>(<span class="fu">view</span>(B, y, <span class="op">:</span>))</span>
<span id="cb6-14"><a href="#cb6-14" aria-hidden="true" tabindex="-1"></a>    <span class="cf">end</span></span>
<span id="cb6-15"><a href="#cb6-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-16"><a href="#cb6-16" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> B</span>
<span id="cb6-17"><a href="#cb6-17" aria-hidden="true" tabindex="-1"></a><span class="kw">end</span></span>
<span id="cb6-18"><a href="#cb6-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-19"><a href="#cb6-19" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="fu">fft_2dcustom</span>(A<span class="op">::</span><span class="dt">AbstractMatrix{T}</span>) <span class="kw">where</span> T<span class="op">&lt;:</span><span class="dt">AbstractFloat</span></span>
<span id="cb6-20"><a href="#cb6-20" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="fu">fft_2dcustom</span>(<span class="fu">Complex</span><span class="dt">{T}.</span>(A))</span>
<span id="cb6-21"><a href="#cb6-21" aria-hidden="true" tabindex="-1"></a><span class="kw">end</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>fft_2dcustom (generic function with 2 methods)</code></pre>
</div>
</div>
<div id="cell-5" class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="fu">fftshift_custom!</span>(dest<span class="op">::</span><span class="dt">AbstractArray</span>,x<span class="op">::</span><span class="dt">AbstractArray</span>)</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Calculate the shift amount for each dimension</span></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>    shifts <span class="op">=</span> <span class="fu">map</span>(s <span class="op">-&gt;</span> <span class="fu">div</span>(s, <span class="fl">2</span>), <span class="fu">size</span>(x))</span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">circshift!</span>(dest,x, shifts)    </span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="cn">nothing</span></span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a><span class="kw">end</span></span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Inverse operation</span></span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="fu">ifftshift_custom!</span>(dest<span class="op">::</span><span class="dt">AbstractArray</span>,x<span class="op">::</span><span class="dt">AbstractArray</span>)</span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a>    shifts <span class="op">=</span> <span class="fu">map</span>(s <span class="op">-&gt;</span> <span class="fu">-div</span>(s, <span class="fl">2</span>), <span class="fu">size</span>(x))</span>
<span id="cb8-11"><a href="#cb8-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">circshift!</span>(dest, x, shifts)</span>
<span id="cb8-12"><a href="#cb8-12" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="cn">nothing</span></span>
<span id="cb8-13"><a href="#cb8-13" aria-hidden="true" tabindex="-1"></a><span class="kw">end</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>ifftshift_custom! (generic function with 2 methods)</code></pre>
</div>
</div>
<div id="cell-6" class="cell" data-execution_count="5">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>A <span class="op">=</span> <span class="fu">rand</span>(<span class="fl">1024</span>, <span class="fl">1024</span>) <span class="op">+</span> <span class="cn">im</span> <span class="op">*</span> <span class="fu">rand</span>(<span class="fl">1024</span>, <span class="fl">1024</span>)</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>B <span class="op">=</span> <span class="fu">rand</span>(<span class="fl">1024</span>, <span class="fl">1024</span>);</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="cell-7" class="cell" data-execution_count="6">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>A_fft_custom <span class="op">=</span> <span class="fu">fft_2dcustom</span>(A)</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>B_fft_custom <span class="op">=</span> <span class="fu">fft_2dcustom</span>(B)</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>A_fft_fftw <span class="op">=</span> <span class="fu">fft</span>(A)</span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>B_fft_fftw <span class="op">=</span> <span class="fu">fft</span>(B)</span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a><span class="pp">@assert</span> A_fft_custom <span class="op">≈</span> A_fft_fftw</span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a><span class="pp">@assert</span> B_fft_custom <span class="op">≈</span> B_fft_fftw</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="cell-8" class="cell" data-execution_count="26">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="fu">methods</span>(circshift!)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
# 11 methods for generic function <b>circshift!</b> from [90mBase[39m:<ul><li> circshift!(dest::<b>BitVector</b>, src::<b>BitVector</b>, i::<b>Integer</b>) in Base at <a href="https://github.com/JuliaLang/julia/tree/5e9a32e7af2837e677e60543d4a15faa8d3a7297/base/bitarray.jl#L1423" target="_blank">bitarray.jl:1423</a></li> <li> circshift!(B::<b>BitVector</b>, i::<b>Integer</b>) in Base at <a href="https://github.com/JuliaLang/julia/tree/5e9a32e7af2837e677e60543d4a15faa8d3a7297/base/bitarray.jl#L1442" target="_blank">bitarray.jl:1442</a></li> <li> circshift!(O::<b>SparseArrays.SparseVector</b>, X::<b>SparseArrays.SparseVector</b>, ::<b>Tuple{Integer}</b>) in SparseArrays at <a href="file:///cache/build/tester-amdci5-12/julialang/julia-release-1-dot-11/usr/share/julia/stdlib/v1.11/SparseArrays/src/sparsevector.jl" target="_blank">/opt/julia-1.11.2/share/julia/stdlib/v1.11/SparseArrays/src/sparsevector.jl:2409</a></li> <li> circshift!(O::<b>SparseArrays.SparseVector</b>, X::<b>SparseArrays.SparseVector</b>, r::<b>Real</b>) in SparseArrays at <a href="file:///cache/build/tester-amdci5-12/julialang/julia-release-1-dot-11/usr/share/julia/stdlib/v1.11/SparseArrays/src/sparsevector.jl" target="_blank">/opt/julia-1.11.2/share/julia/stdlib/v1.11/SparseArrays/src/sparsevector.jl:2415</a></li> <li> circshift!(O::<b>SparseArrays.AbstractSparseMatrixCSC</b>, X::<b>SparseArrays.AbstractSparseMatrixCSC</b>, ::<b>Tuple{Integer, Integer}</b>) in SparseArrays at <a href="file:///cache/build/tester-amdci5-12/julialang/julia-release-1-dot-11/usr/share/julia/stdlib/v1.11/SparseArrays/src/sparsematrix.jl" target="_blank">/opt/julia-1.11.2/share/julia/stdlib/v1.11/SparseArrays/src/sparsematrix.jl:4350</a></li> <li> circshift!(O::<b>SparseArrays.AbstractSparseMatrixCSC</b>, X::<b>SparseArrays.AbstractSparseMatrixCSC</b>, ::<b>Tuple{Integer}</b>) in SparseArrays at <a href="file:///cache/build/tester-amdci5-12/julialang/julia-release-1-dot-11/usr/share/julia/stdlib/v1.11/SparseArrays/src/sparsematrix.jl" target="_blank">/opt/julia-1.11.2/share/julia/stdlib/v1.11/SparseArrays/src/sparsematrix.jl:4388</a></li> <li> circshift!(O::<b>SparseArrays.AbstractSparseMatrixCSC</b>, X::<b>SparseArrays.AbstractSparseMatrixCSC</b>, r::<b>Real</b>) in SparseArrays at <a href="file:///cache/build/tester-amdci5-12/julialang/julia-release-1-dot-11/usr/share/julia/stdlib/v1.11/SparseArrays/src/sparsematrix.jl" target="_blank">/opt/julia-1.11.2/share/julia/stdlib/v1.11/SparseArrays/src/sparsematrix.jl:4389</a></li> <li> circshift!(a::<b>AbstractVector</b>, shift::<b>Integer</b>) in Base at <a href="https://github.com/JuliaLang/julia/tree/5e9a32e7af2837e677e60543d4a15faa8d3a7297/base/abstractarray.jl#L3658" target="_blank">abstractarray.jl:3658</a></li> <li> circshift!(dest::<b>AbstractArray</b>, src, ::<b>Tuple{}</b>) in Base at <a href="https://github.com/JuliaLang/julia/tree/5e9a32e7af2837e677e60543d4a15faa8d3a7297/base/multidimensional.jl#L1205" target="_blank">multidimensional.jl:1205</a></li> <li> circshift!(dest::<b>AbstractArray{T, N}</b>, src, shiftamt::<b>NTuple{N, Integer} where N</b>)<i> where {T, N}</i> in Base at <a href="https://github.com/JuliaLang/julia/tree/5e9a32e7af2837e677e60543d4a15faa8d3a7297/base/multidimensional.jl#L1216" target="_blank">multidimensional.jl:1216</a></li> <li> circshift!(dest::<b>AbstractArray</b>, src, shiftamt) in Base at <a href="https://github.com/JuliaLang/julia/tree/5e9a32e7af2837e677e60543d4a15faa8d3a7297/base/multidimensional.jl#L1224" target="_blank">multidimensional.jl:1224</a></li> </ul>
</div>
</div>
<div id="cell-9" class="cell" data-execution_count="36">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>A1 <span class="op">=</span> <span class="fu">rand</span>(<span class="fl">1024</span>, <span class="fl">1024</span><span class="op">+</span><span class="fl">3</span>) <span class="op">+</span> <span class="cn">im</span> <span class="op">*</span> <span class="fu">rand</span>(<span class="fl">1024</span>, <span class="fl">1024</span><span class="op">+</span><span class="fl">3</span>)</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>a_cumstom <span class="op">=</span> <span class="fu">copy</span>(A1)</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>a_fft <span class="op">=</span> <span class="fu">copy</span>(A1)</span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>dest <span class="op">=</span> <span class="fu">copy</span>(A1)</span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a><span class="fu">fftshift_custom!</span>(dest,a_fft)</span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a><span class="fu">fftshift_custom!</span>(dest,a_fft)</span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a><span class="pp">@assert</span> <span class="fu">fftshift</span>(a_cumstom) <span class="op">≈</span> dest</span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a><span class="pp">@benchmark</span> <span class="fu">fftshift_custom!</span>(dest, a_fft)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div class="ansi-escaped-output">
<pre>BenchmarkTools.Trial: 1483 samples with 1 evaluation per sample.
 Range <span class="ansi-bright-black-fg">(</span><span class="ansi-cyan-fg ansi-bold">min</span> … <span class="ansi-magenta-fg">max</span><span class="ansi-bright-black-fg">):  </span><span class="ansi-cyan-fg ansi-bold">2.105 ms</span> … <span class="ansi-magenta-fg">  5.980 ms</span>  <span class="ansi-bright-black-fg">┊</span> GC <span class="ansi-bright-black-fg">(</span>min … max<span class="ansi-bright-black-fg">): </span>0.00% … 0.00%
 Time  <span class="ansi-bright-black-fg">(</span><span class="ansi-blue-fg ansi-bold">median</span><span class="ansi-bright-black-fg">):     </span><span class="ansi-blue-fg ansi-bold">3.268 ms               </span><span class="ansi-bright-black-fg">┊</span> GC <span class="ansi-bright-black-fg">(</span>median<span class="ansi-bright-black-fg">):    </span>0.00%
 Time  <span class="ansi-bright-black-fg">(</span><span class="ansi-green-fg ansi-bold">mean</span> ± <span class="ansi-green-fg">σ</span><span class="ansi-bright-black-fg">):   </span><span class="ansi-green-fg ansi-bold">3.355 ms</span> ± <span class="ansi-green-fg">926.125 μs</span>  <span class="ansi-bright-black-fg">┊</span> GC <span class="ansi-bright-black-fg">(</span>mean ± σ<span class="ansi-bright-black-fg">):  </span>0.00% ± 0.00%
   ▄█▄               <span class="ansi-blue-fg"> </span> <span class="ansi-green-fg"> </span>                                       
  ▆███▇▆▆▆▆▅▃▄▄▅▆█▅▇▆<span class="ansi-blue-fg">▇</span>▅<span class="ansi-green-fg">▅</span>▇▇▇▇▇▅▄▄▅▅▄▅▅▅▆▇▆▅▃▅▄▃▄▃▃▃▃▃▃▃▁▄▃▃▃▃▃ ▄
  2.1 ms<span class="ansi-bright-black-fg">          Histogram: frequency by time</span>        5.64 ms <span class="ansi-bold">&lt;</span>
 Memory estimate<span class="ansi-bright-black-fg">: </span><span class="ansi-yellow-fg">0 bytes</span>, allocs estimate<span class="ansi-bright-black-fg">: </span><span class="ansi-yellow-fg">0</span>.</pre>
</div>
</div>
</div>
<div id="cell-10" class="cell" data-execution_count="37">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="pp">@benchmark</span> <span class="fu">fftshift</span>(a_cumstom)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div class="ansi-escaped-output">
<pre>BenchmarkTools.Trial: 1399 samples with 1 evaluation per sample.
 Range <span class="ansi-bright-black-fg">(</span><span class="ansi-cyan-fg ansi-bold">min</span> … <span class="ansi-magenta-fg">max</span><span class="ansi-bright-black-fg">):  </span><span class="ansi-cyan-fg ansi-bold">2.272 ms</span> … <span class="ansi-magenta-fg"> 10.258 ms</span>  <span class="ansi-bright-black-fg">┊</span> GC <span class="ansi-bright-black-fg">(</span>min … max<span class="ansi-bright-black-fg">): </span> 0.00% … 11.78%
 Time  <span class="ansi-bright-black-fg">(</span><span class="ansi-blue-fg ansi-bold">median</span><span class="ansi-bright-black-fg">):     </span><span class="ansi-blue-fg ansi-bold">3.586 ms               </span><span class="ansi-bright-black-fg">┊</span> GC <span class="ansi-bright-black-fg">(</span>median<span class="ansi-bright-black-fg">):    </span> 0.00%
 Time  <span class="ansi-bright-black-fg">(</span><span class="ansi-green-fg ansi-bold">mean</span> ± <span class="ansi-green-fg">σ</span><span class="ansi-bright-black-fg">):   </span><span class="ansi-green-fg ansi-bold">3.560 ms</span> ± <span class="ansi-green-fg">770.248 μs</span>  <span class="ansi-bright-black-fg">┊</span> GC <span class="ansi-bright-black-fg">(</span>mean ± σ<span class="ansi-bright-black-fg">):  </span>10.03% ± 11.46%
    ▄             ▅█▅       <span class="ansi-blue-fg">▃</span>▅▃                                
  ▃▆█▇▄▃▅▃▃▃▂▃▂▂▃▆███▇▆▇▅▄▆▆<span class="ansi-blue-fg">█</span>███▆▇▇▆▅▄▄▄▆▅█▇▆▄▃▄▂▃▃▁▃▂▂▃▃▃▃▃▃ ▄
  2.27 ms<span class="ansi-bright-black-fg">         Histogram: frequency by time</span>        5.22 ms <span class="ansi-bold">&lt;</span>
 Memory estimate<span class="ansi-bright-black-fg">: </span><span class="ansi-yellow-fg">16.05 MiB</span>, allocs estimate<span class="ansi-bright-black-fg">: </span><span class="ansi-yellow-fg">3</span>.</pre>
</div>
</div>
</div>
<div id="cell-11" class="cell" data-execution_count="38">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="pp">@benchmark</span> <span class="fu">fftshift!</span>(dest,a_cumstom)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div class="ansi-escaped-output">
<pre>BenchmarkTools.Trial: 1513 samples with 1 evaluation per sample.
 Range <span class="ansi-bright-black-fg">(</span><span class="ansi-cyan-fg ansi-bold">min</span> … <span class="ansi-magenta-fg">max</span><span class="ansi-bright-black-fg">):  </span><span class="ansi-cyan-fg ansi-bold">2.084 ms</span> … <span class="ansi-magenta-fg">  6.384 ms</span>  <span class="ansi-bright-black-fg">┊</span> GC <span class="ansi-bright-black-fg">(</span>min … max<span class="ansi-bright-black-fg">): </span>0.00% … 0.00%
 Time  <span class="ansi-bright-black-fg">(</span><span class="ansi-blue-fg ansi-bold">median</span><span class="ansi-bright-black-fg">):     </span><span class="ansi-blue-fg ansi-bold">3.288 ms               </span><span class="ansi-bright-black-fg">┊</span> GC <span class="ansi-bright-black-fg">(</span>median<span class="ansi-bright-black-fg">):    </span>0.00%
 Time  <span class="ansi-bright-black-fg">(</span><span class="ansi-green-fg ansi-bold">mean</span> ± <span class="ansi-green-fg">σ</span><span class="ansi-bright-black-fg">):   </span><span class="ansi-green-fg ansi-bold">3.288 ms</span> ± <span class="ansi-green-fg">819.287 μs</span>  <span class="ansi-bright-black-fg">┊</span> GC <span class="ansi-bright-black-fg">(</span>mean ± σ<span class="ansi-bright-black-fg">):  </span>0.00% ± 0.00%
    ██               ▁▂<span class="ansi-blue-fg">▁</span> ▁▂▁                                   
  ▄▇██▆▆▆▆▅▅▄▃▄▄▃▅▅▃▅██<span class="ansi-blue-fg">█</span>▇███▆█▇▆▄▆▄▅▄▄▄▃▃▃▄▄▃▃▃▃▂▂▃▃▂▂▂▂▁▁▁▁▂ ▃
  2.08 ms<span class="ansi-bright-black-fg">         Histogram: frequency by time</span>         5.4 ms <span class="ansi-bold">&lt;</span>
 Memory estimate<span class="ansi-bright-black-fg">: </span><span class="ansi-yellow-fg">0 bytes</span>, allocs estimate<span class="ansi-bright-black-fg">: </span><span class="ansi-yellow-fg">0</span>.</pre>
</div>
</div>
</div>
<div id="cell-12" class="cell">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>0</code></pre>
</div>
</div>
<div id="cell-13" class="cell" data-execution_count="8">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>test <span class="op">=</span> <span class="fu">ones</span>(<span class="fl">8</span>, <span class="fl">8</span>)</span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>test_fft <span class="op">=</span> <span class="fu">fftshift</span>(<span class="fu">fft</span>(test))</span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>test_fft_custom <span class="op">=</span> <span class="fu">fftshift</span>(<span class="fu">fft_2dcustom</span>(test))</span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a><span class="fu">println</span>(test_fft <span class="op">≈</span> test_fft_custom)</span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a><span class="fu">heatmap</span>(<span class="fu">abs2</span>.(<span class="fu">fftshift</span>(<span class="fu">fft_2dcustom</span>(test))), title<span class="op">=</span><span class="st">"Custom FFT 2D"</span>, xlabel<span class="op">=</span><span class="st">"Frequency X"</span>, ylabel<span class="op">=</span><span class="st">"Frequency Y"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>true</code></pre>
</div>
<div class="cell-output cell-output-error">
<pre><code>UndefVarError: UndefVarError: `heatmap` not defined in `Main`
Suggestion: check for spelling errors or missing imports.
UndefVarError: `heatmap` not defined in `Main`

Suggestion: check for spelling errors or missing imports.



Stacktrace:

 [1] top-level scope

   @ ~/Desktop/julia_functions/jl_notebook_cell_df34fa98e69747e1a8f8a730347b8e2f_W6sZmlsZQ==.jl:5</code></pre>
</div>
</div>
<div id="cell-14" class="cell" data-execution_count="9">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>a <span class="op">=</span> <span class="fu">Complex</span>.(<span class="fu">rand</span>(<span class="fl">1024</span>)) <span class="op">.+</span> <span class="cn">im</span> <span class="op">.*</span> <span class="fu">Complex</span>.(<span class="fu">rand</span>(<span class="fl">1024</span>))</span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>a_fft_custom <span class="op">=</span> <span class="fu">fft</span>(a);</span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a><span class="pp">@benchmark</span> <span class="fu">fft</span>(a)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div class="ansi-escaped-output">
<pre>BenchmarkTools.Trial: 10000 samples with 5 evaluations per sample.
 Range <span class="ansi-bright-black-fg">(</span><span class="ansi-cyan-fg ansi-bold">min</span> … <span class="ansi-magenta-fg">max</span><span class="ansi-bright-black-fg">):  </span><span class="ansi-cyan-fg ansi-bold"> 6.009 μs</span> … <span class="ansi-magenta-fg"> 3.792 ms</span>  <span class="ansi-bright-black-fg">┊</span> GC <span class="ansi-bright-black-fg">(</span>min … max<span class="ansi-bright-black-fg">): </span>0.00% … 33.45%
 Time  <span class="ansi-bright-black-fg">(</span><span class="ansi-blue-fg ansi-bold">median</span><span class="ansi-bright-black-fg">):     </span><span class="ansi-blue-fg ansi-bold"> 6.981 μs              </span><span class="ansi-bright-black-fg">┊</span> GC <span class="ansi-bright-black-fg">(</span>median<span class="ansi-bright-black-fg">):    </span>0.00%
 Time  <span class="ansi-bright-black-fg">(</span><span class="ansi-green-fg ansi-bold">mean</span> ± <span class="ansi-green-fg">σ</span><span class="ansi-bright-black-fg">):   </span><span class="ansi-green-fg ansi-bold">10.373 μs</span> ± <span class="ansi-green-fg">55.333 μs</span>  <span class="ansi-bright-black-fg">┊</span> GC <span class="ansi-bright-black-fg">(</span>mean ± σ<span class="ansi-bright-black-fg">):  </span>5.56% ±  1.41%
  ▁▄▇█<span class="ansi-blue-fg">▆</span>▅▄▄▃▃▂▂▁▁▁▁▁▁ <span class="ansi-green-fg">▁</span>▁ ▁▁▁▂▃▃▃▃▂▂▂▂▂▁▁                       ▂
  ████<span class="ansi-blue-fg">█</span>██████████████<span class="ansi-green-fg">█</span>████████████████████▇▇▇▇▇▇▇▇▇▆▇▆▆▆▆▆▆▅▅ █
  6.01 μs<span class="ansi-bright-black-fg">      </span><span class="ansi-bright-black-fg">Histogram: </span><span class="ansi-bright-black-fg ansi-bold">log(</span><span class="ansi-bright-black-fg">frequency</span><span class="ansi-bright-black-fg ansi-bold">)</span><span class="ansi-bright-black-fg"> by time</span>      19.4 μs <span class="ansi-bold">&lt;</span>
 Memory estimate<span class="ansi-bright-black-fg">: </span><span class="ansi-yellow-fg">16.33 KiB</span>, allocs estimate<span class="ansi-bright-black-fg">: </span><span class="ansi-yellow-fg">8</span>.</pre>
</div>
</div>
</div>
<div id="cell-15" class="cell" data-execution_count="22">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>reals <span class="op">=</span> <span class="fu">real</span>.(a)</span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>imags <span class="op">=</span> <span class="fu">imag</span>.(a)</span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a><span class="pp">@benchmark</span> <span class="fu">fft_1dgpt!</span>(reals, imags)</span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a><span class="co"># @assert reals ≈ real.(a_fft_custom)</span></span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a><span class="co"># @assert imags ≈ imag.(a_fft_custom)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div class="ansi-escaped-output">
<pre>BenchmarkTools.Trial: 10000 samples with 1 evaluation per sample.
 Range <span class="ansi-bright-black-fg">(</span><span class="ansi-cyan-fg ansi-bold">min</span> … <span class="ansi-magenta-fg">max</span><span class="ansi-bright-black-fg">):  </span><span class="ansi-cyan-fg ansi-bold">42.539 μs</span> … <span class="ansi-magenta-fg">78.187 μs</span>  <span class="ansi-bright-black-fg">┊</span> GC <span class="ansi-bright-black-fg">(</span>min … max<span class="ansi-bright-black-fg">): </span>0.00% … 0.00%
 Time  <span class="ansi-bright-black-fg">(</span><span class="ansi-blue-fg ansi-bold">median</span><span class="ansi-bright-black-fg">):     </span><span class="ansi-blue-fg ansi-bold">46.567 μs              </span><span class="ansi-bright-black-fg">┊</span> GC <span class="ansi-bright-black-fg">(</span>median<span class="ansi-bright-black-fg">):    </span>0.00%
 Time  <span class="ansi-bright-black-fg">(</span><span class="ansi-green-fg ansi-bold">mean</span> ± <span class="ansi-green-fg">σ</span><span class="ansi-bright-black-fg">):   </span><span class="ansi-green-fg ansi-bold">47.203 μs</span> ± <span class="ansi-green-fg"> 3.331 μs</span>  <span class="ansi-bright-black-fg">┊</span> GC <span class="ansi-bright-black-fg">(</span>mean ± σ<span class="ansi-bright-black-fg">):  </span>0.00% ± 0.00%
          ▅     <span class="ansi-blue-fg"> </span> <span class="ansi-green-fg"> </span>          █                                 
  ▂▄▃▅▄▃▄▃█▄▄▃▄▆<span class="ansi-blue-fg">▇</span>▆<span class="ansi-green-fg">▃</span>▄█▃▂▁▁▁▁▁▁█▃▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁ ▂
  42.5 μs<span class="ansi-bright-black-fg">         Histogram: frequency by time</span>          60 μs <span class="ansi-bold">&lt;</span>
 Memory estimate<span class="ansi-bright-black-fg">: </span><span class="ansi-yellow-fg">0 bytes</span>, allocs estimate<span class="ansi-bright-black-fg">: </span><span class="ansi-yellow-fg">0</span>.</pre>
</div>
</div>
</div>
<div id="cell-16" class="cell" data-execution_count="11">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="fu">println</span>(imags[<span class="fl">1</span><span class="op">:</span><span class="fl">10</span>])</span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a><span class="fu">println</span>(<span class="fu">imag</span>.(a_fft_custom)[<span class="fl">1</span><span class="op">:</span><span class="fl">10</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[0.8285304472569426, 0.851857007404441, 0.1592271527401642, 0.7794039528900412, 0.16614725398876395, 0.22262794209526726, 0.9695421109047757, 0.6894412890876838, 0.9395922092962491, 0.8861822686815922]
[517.0169627377404, 24.344073851918537, -9.594306241927015, 13.110364012337032, -8.722020496715219, 6.713355713884441, -2.9990449691718357, 3.260948477454004, -6.136491623512576, -16.615056922515482]</code></pre>
</div>
</div>
<div id="cell-17" class="cell" data-execution_count="12">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="pp">@benchmark</span> <span class="fu">fft_1dgpt</span>(a)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div class="ansi-escaped-output">
<pre>BenchmarkTools.Trial: 10000 samples with 1 evaluation per sample.
 Range <span class="ansi-bright-black-fg">(</span><span class="ansi-cyan-fg ansi-bold">min</span> … <span class="ansi-magenta-fg">max</span><span class="ansi-bright-black-fg">):  </span><span class="ansi-cyan-fg ansi-bold">11.612 μs</span> … <span class="ansi-magenta-fg"> 1.673 ms</span>  <span class="ansi-bright-black-fg">┊</span> GC <span class="ansi-bright-black-fg">(</span>min … max<span class="ansi-bright-black-fg">): </span>0.00% … 97.49%
 Time  <span class="ansi-bright-black-fg">(</span><span class="ansi-blue-fg ansi-bold">median</span><span class="ansi-bright-black-fg">):     </span><span class="ansi-blue-fg ansi-bold">12.193 μs              </span><span class="ansi-bright-black-fg">┊</span> GC <span class="ansi-bright-black-fg">(</span>median<span class="ansi-bright-black-fg">):    </span>0.00%
 Time  <span class="ansi-bright-black-fg">(</span><span class="ansi-green-fg ansi-bold">mean</span> ± <span class="ansi-green-fg">σ</span><span class="ansi-bright-black-fg">):   </span><span class="ansi-green-fg ansi-bold">13.202 μs</span> ± <span class="ansi-green-fg">16.708 μs</span>  <span class="ansi-bright-black-fg">┊</span> GC <span class="ansi-bright-black-fg">(</span>mean ± σ<span class="ansi-bright-black-fg">):  </span>1.24% ±  0.97%
  ▁▅▇█<span class="ansi-blue-fg">█</span>▆▅▃▂▂▂▁<span class="ansi-green-fg">▂</span>▁▁▂▁▁▂▂▁▁▂▂▂▂▂▂▂▂▂▂▂▁▁▁▁▁▁▁▁                   ▂
  ████<span class="ansi-blue-fg">█</span>███████<span class="ansi-green-fg">█</span>███████████████████████████████▇▇▇▇▇▆▇▇▆▅▆▆▄▄▅ █
  11.6 μs<span class="ansi-bright-black-fg">      </span><span class="ansi-bright-black-fg">Histogram: </span><span class="ansi-bright-black-fg ansi-bold">log(</span><span class="ansi-bright-black-fg">frequency</span><span class="ansi-bright-black-fg ansi-bold">)</span><span class="ansi-bright-black-fg"> by time</span>      19.4 μs <span class="ansi-bold">&lt;</span>
 Memory estimate<span class="ansi-bright-black-fg">: </span><span class="ansi-yellow-fg">16.06 KiB</span>, allocs estimate<span class="ansi-bright-black-fg">: </span><span class="ansi-yellow-fg">3</span>.</pre>
</div>
</div>
</div>
<div id="cell-18" class="cell" data-execution_count="13">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="pp">@benchmark</span> <span class="fu">fft</span>(a)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div class="ansi-escaped-output">
<pre>BenchmarkTools.Trial: 10000 samples with 5 evaluations per sample.
 Range <span class="ansi-bright-black-fg">(</span><span class="ansi-cyan-fg ansi-bold">min</span> … <span class="ansi-magenta-fg">max</span><span class="ansi-bright-black-fg">):  </span><span class="ansi-cyan-fg ansi-bold"> 6.474 μs</span> … <span class="ansi-magenta-fg"> 3.649 ms</span>  <span class="ansi-bright-black-fg">┊</span> GC <span class="ansi-bright-black-fg">(</span>min … max<span class="ansi-bright-black-fg">): </span>0.00% … 23.58%
 Time  <span class="ansi-bright-black-fg">(</span><span class="ansi-blue-fg ansi-bold">median</span><span class="ansi-bright-black-fg">):     </span><span class="ansi-blue-fg ansi-bold"> 7.388 μs              </span><span class="ansi-bright-black-fg">┊</span> GC <span class="ansi-bright-black-fg">(</span>median<span class="ansi-bright-black-fg">):    </span>0.00%
 Time  <span class="ansi-bright-black-fg">(</span><span class="ansi-green-fg ansi-bold">mean</span> ± <span class="ansi-green-fg">σ</span><span class="ansi-bright-black-fg">):   </span><span class="ansi-green-fg ansi-bold">10.515 μs</span> ± <span class="ansi-green-fg">54.387 μs</span>  <span class="ansi-bright-black-fg">┊</span> GC <span class="ansi-bright-black-fg">(</span>mean ± σ<span class="ansi-bright-black-fg">):  </span>5.27% ±  1.47%
  ▁▅██<span class="ansi-blue-fg">▆</span>▅▄▄▄▃▃▃▃▂▁▁▁▁<span class="ansi-green-fg"> </span>▁  ▁ ▁▁▁▁▁▁▁▁▁▁▁▁ ▁▁                     ▂
  ████<span class="ansi-blue-fg">█</span>█████████████<span class="ansi-green-fg">█</span>███████████████████████▇█▇▇█▇▇▆▇▆▆▇▅▅▅▅▅ █
  6.47 μs<span class="ansi-bright-black-fg">      </span><span class="ansi-bright-black-fg">Histogram: </span><span class="ansi-bright-black-fg ansi-bold">log(</span><span class="ansi-bright-black-fg">frequency</span><span class="ansi-bright-black-fg ansi-bold">)</span><span class="ansi-bright-black-fg"> by time</span>      19.8 μs <span class="ansi-bold">&lt;</span>
 Memory estimate<span class="ansi-bright-black-fg">: </span><span class="ansi-yellow-fg">16.33 KiB</span>, allocs estimate<span class="ansi-bright-black-fg">: </span><span class="ansi-yellow-fg">8</span>.</pre>
</div>
</div>
</div>
<div id="cell-19" class="cell" data-execution_count="14">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="pp">@benchmark</span> <span class="fu">fft_2dcustom</span>(A)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div class="ansi-escaped-output">
<pre>BenchmarkTools.Trial: 100 samples with 1 evaluation per sample.
 Range <span class="ansi-bright-black-fg">(</span><span class="ansi-cyan-fg ansi-bold">min</span> … <span class="ansi-magenta-fg">max</span><span class="ansi-bright-black-fg">):  </span><span class="ansi-cyan-fg ansi-bold">44.359 ms</span> … <span class="ansi-magenta-fg">116.520 ms</span>  <span class="ansi-bright-black-fg">┊</span> GC <span class="ansi-bright-black-fg">(</span>min … max<span class="ansi-bright-black-fg">): </span>0.00% … 56.32%
 Time  <span class="ansi-bright-black-fg">(</span><span class="ansi-blue-fg ansi-bold">median</span><span class="ansi-bright-black-fg">):     </span><span class="ansi-blue-fg ansi-bold">47.388 ms               </span><span class="ansi-bright-black-fg">┊</span> GC <span class="ansi-bright-black-fg">(</span>median<span class="ansi-bright-black-fg">):    </span>3.68%
 Time  <span class="ansi-bright-black-fg">(</span><span class="ansi-green-fg ansi-bold">mean</span> ± <span class="ansi-green-fg">σ</span><span class="ansi-bright-black-fg">):   </span><span class="ansi-green-fg ansi-bold">50.178 ms</span> ± <span class="ansi-green-fg"> 11.397 ms</span>  <span class="ansi-bright-black-fg">┊</span> GC <span class="ansi-bright-black-fg">(</span>mean ± σ<span class="ansi-bright-black-fg">):  </span>7.33% ± 10.15%
  ▃▅▆<span class="ansi-blue-fg">█</span>▅▃<span class="ansi-green-fg">▁</span>                                                       
  ███<span class="ansi-blue-fg">█</span>██<span class="ansi-green-fg">█</span>▅▁▁▁▁▁▁▅▁▅▁▁▁▅▁▁▁▁▁▁▅▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▅▅▁▅ ▅
  44.4 ms<span class="ansi-bright-black-fg">       </span><span class="ansi-bright-black-fg">Histogram: </span><span class="ansi-bright-black-fg ansi-bold">log(</span><span class="ansi-bright-black-fg">frequency</span><span class="ansi-bright-black-fg ansi-bold">)</span><span class="ansi-bright-black-fg"> by time</span>      99.9 ms <span class="ansi-bold">&lt;</span>
 Memory estimate<span class="ansi-bright-black-fg">: </span><span class="ansi-yellow-fg">48.13 MiB</span>, allocs estimate<span class="ansi-bright-black-fg">: </span><span class="ansi-yellow-fg">6147</span>.</pre>
</div>
</div>
</div>
<div id="cell-20" class="cell" data-execution_count="15">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="pp">@benchmark</span> <span class="fu">fft</span>(A)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div class="ansi-escaped-output">
<pre>BenchmarkTools.Trial: 123 samples with 1 evaluation per sample.
 Range <span class="ansi-bright-black-fg">(</span><span class="ansi-cyan-fg ansi-bold">min</span> … <span class="ansi-magenta-fg">max</span><span class="ansi-bright-black-fg">):  </span><span class="ansi-cyan-fg ansi-bold">37.039 ms</span> … <span class="ansi-magenta-fg">62.632 ms</span>  <span class="ansi-bright-black-fg">┊</span> GC <span class="ansi-bright-black-fg">(</span>min … max<span class="ansi-bright-black-fg">): </span>0.00% … 0.00%
 Time  <span class="ansi-bright-black-fg">(</span><span class="ansi-blue-fg ansi-bold">median</span><span class="ansi-bright-black-fg">):     </span><span class="ansi-blue-fg ansi-bold">39.345 ms              </span><span class="ansi-bright-black-fg">┊</span> GC <span class="ansi-bright-black-fg">(</span>median<span class="ansi-bright-black-fg">):    </span>1.62%
 Time  <span class="ansi-bright-black-fg">(</span><span class="ansi-green-fg ansi-bold">mean</span> ± <span class="ansi-green-fg">σ</span><span class="ansi-bright-black-fg">):   </span><span class="ansi-green-fg ansi-bold">40.830 ms</span> ± <span class="ansi-green-fg"> 4.544 ms</span>  <span class="ansi-bright-black-fg">┊</span> GC <span class="ansi-bright-black-fg">(</span>mean ± σ<span class="ansi-bright-black-fg">):  </span>1.80% ± 1.59%
     ▅█▆<span class="ansi-blue-fg">▇</span>   <span class="ansi-green-fg"> </span>                                                  
  ▅▅▆███<span class="ansi-blue-fg">█</span>▆▆▃<span class="ansi-green-fg">▃</span>▄▁▃▁▃▃▃▃▁▁▃▁▁▄▁▄▁▁▁▃▁▁▃▁▃▁▁▁▁▁▃▁▁▃▁▁▁▁▁▁▁▁▁▁▁▃▁▃ ▃
  37 ms<span class="ansi-bright-black-fg">           Histogram: frequency by time</span>        60.4 ms <span class="ansi-bold">&lt;</span>
 Memory estimate<span class="ansi-bright-black-fg">: </span><span class="ansi-yellow-fg">16.00 MiB</span>, allocs estimate<span class="ansi-bright-black-fg">: </span><span class="ansi-yellow-fg">8</span>.</pre>
</div>
</div>
</div>
<div id="cell-21" class="cell" data-execution_count="16">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="im">using</span> <span class="bu">Plots</span></span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a><span class="im">using</span> <span class="bu">JuMP</span></span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a><span class="im">using</span> <span class="bu">Ipopt</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-error">
<pre><code>ArgumentError: ArgumentError: Package JuMP not found in current path.
- Run `import Pkg; Pkg.add("JuMP")` to install the JuMP package.
ArgumentError: Package JuMP not found in current path.

- Run `import Pkg; Pkg.add("JuMP")` to install the JuMP package.



Stacktrace:

  [1] macro expansion

    @ ./loading.jl:2296 [inlined]

  [2] macro expansion

    @ ./lock.jl:273 [inlined]

  [3] __require(into::Module, mod::Symbol)

    @ Base ./loading.jl:2271

  [4] #invoke_in_world#3

    @ ./essentials.jl:1089 [inlined]

  [5] invoke_in_world

    @ ./essentials.jl:1086 [inlined]

  [6] require(into::Module, mod::Symbol)

    @ Base ./loading.jl:2260

  [7] eval

    @ ./boot.jl:430 [inlined]

  [8] include_string(mapexpr::typeof(REPL.softscope), mod::Module, code::String, filename::String)

    @ Base ./loading.jl:2734

  [9] #invokelatest#2

    @ ./essentials.jl:1055 [inlined]

 [10] invokelatest

    @ ./essentials.jl:1052 [inlined]

 [11] (::VSCodeServer.var"#217#218"{VSCodeServer.NotebookRunCellArguments, String})()

    @ VSCodeServer ~/.vscode/extensions/julialang.language-julia-1.141.2/scripts/packages/VSCodeServer/src/serve_notebook.jl:24

 [12] withpath(f::VSCodeServer.var"#217#218"{VSCodeServer.NotebookRunCellArguments, String}, path::String)

    @ VSCodeServer ~/.vscode/extensions/julialang.language-julia-1.141.2/scripts/packages/VSCodeServer/src/repl.jl:276

 [13] notebook_runcell_request(conn::VSCodeServer.JSONRPC.JSONRPCEndpoint{Base.PipeEndpoint, Base.PipeEndpoint, VSCodeServer.JSON.Serializations.StandardSerialization}, params::VSCodeServer.NotebookRunCellArguments, token::VSCodeServer.CancellationTokens.CancellationToken)

    @ VSCodeServer ~/.vscode/extensions/julialang.language-julia-1.141.2/scripts/packages/VSCodeServer/src/serve_notebook.jl:13

 [14] dispatch_msg(x::VSCodeServer.JSONRPC.JSONRPCEndpoint{Base.PipeEndpoint, Base.PipeEndpoint, VSCodeServer.JSON.Serializations.StandardSerialization}, dispatcher::VSCodeServer.JSONRPC.MsgDispatcher, msg::VSCodeServer.JSONRPC.Request)

    @ VSCodeServer.JSONRPC ~/.vscode/extensions/julialang.language-julia-1.141.2/scripts/packages/JSONRPC/src/typed.jl:68

 [15] serve_notebook(pipename::String, debugger_pipename::String, outputchannel_logger::Base.CoreLogging.SimpleLogger; error_handler::var"#5#10"{String})

    @ VSCodeServer ~/.vscode/extensions/julialang.language-julia-1.141.2/scripts/packages/VSCodeServer/src/serve_notebook.jl:147

 [16] top-level scope

    @ ~/.vscode/extensions/julialang.language-julia-1.141.2/scripts/notebook/notebook.jl:35</code></pre>
</div>
</div>
<div id="cell-22" class="cell" data-execution_count="17">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="kw">struct</span> MinimizingFunc</span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>    x<span class="op">::</span><span class="dt">Vector{Float64}</span></span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a>    y_data<span class="op">::</span><span class="dt">Vector{Float64}</span></span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a>    <span class="co"># amk::Array{Any, 3}</span></span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a>    <span class="co"># params::Vector{Float64}</span></span>
<span id="cb31-6"><a href="#cb31-6" aria-hidden="true" tabindex="-1"></a><span class="kw">end</span></span>
<span id="cb31-7"><a href="#cb31-7" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> (pv<span class="op">::</span><span class="dt">MinimizingFunc</span>)(m, b)</span>
<span id="cb31-8"><a href="#cb31-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-9"><a href="#cb31-9" aria-hidden="true" tabindex="-1"></a>   </span>
<span id="cb31-10"><a href="#cb31-10" aria-hidden="true" tabindex="-1"></a>    model_real <span class="op">=</span> @. <span class="fu">sin</span>(m<span class="op">*</span>pv.x) <span class="op">+</span> b</span>
<span id="cb31-11"><a href="#cb31-11" aria-hidden="true" tabindex="-1"></a>    model_imag <span class="op">=</span> model_real<span class="op">.*</span><span class="fu">zero</span>(model_real)</span>
<span id="cb31-12"><a href="#cb31-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-13"><a href="#cb31-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-14"><a href="#cb31-14" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb31-15"><a href="#cb31-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-16"><a href="#cb31-16" aria-hidden="true" tabindex="-1"></a>    <span class="fu">fft_1dgpt!</span>(model_real, model_imag)</span>
<span id="cb31-17"><a href="#cb31-17" aria-hidden="true" tabindex="-1"></a>    <span class="co"># model_abs = @. sqrt(model_real^2 + model_imag^2)</span></span>
<span id="cb31-18"><a href="#cb31-18" aria-hidden="true" tabindex="-1"></a>    <span class="co"># half_real = model_fft[1:2:end]</span></span>
<span id="cb31-19"><a href="#cb31-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-20"><a href="#cb31-20" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb31-21"><a href="#cb31-21" aria-hidden="true" tabindex="-1"></a>    obj <span class="op">=</span> <span class="fu">sum</span>((model_real <span class="op">.-</span> pv.y_data)<span class="op">.^</span><span class="fl">2</span>)</span>
<span id="cb31-22"><a href="#cb31-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-23"><a href="#cb31-23" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> obj</span>
<span id="cb31-24"><a href="#cb31-24" aria-hidden="true" tabindex="-1"></a><span class="kw">end</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="cell-23" class="cell" data-execution_count="18">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a>N <span class="op">=</span> <span class="fl">2</span><span class="op">^</span><span class="fl">8</span></span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a>amk <span class="op">=</span> <span class="fu">Array</span><span class="dt">{Any}</span>(<span class="cn">undef</span>, N)</span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a>z<span class="op">::</span><span class="dt">Vector{Float64} </span><span class="op">=</span> <span class="fu">LinRange</span>(<span class="fl">0</span>, <span class="fl">10</span>, N)</span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a>m <span class="op">=</span> <span class="fl">20</span></span>
<span id="cb32-5"><a href="#cb32-5" aria-hidden="true" tabindex="-1"></a>b <span class="op">=</span> <span class="fl">0.4</span></span>
<span id="cb32-6"><a href="#cb32-6" aria-hidden="true" tabindex="-1"></a><span class="co"># x = 0:0.1:10</span></span>
<span id="cb32-7"><a href="#cb32-7" aria-hidden="true" tabindex="-1"></a>noise <span class="op">=</span> <span class="fu">randn</span>(<span class="fu">length</span>(z))</span>
<span id="cb32-8"><a href="#cb32-8" aria-hidden="true" tabindex="-1"></a>y <span class="op">=</span> @. <span class="fu">sin</span>(m<span class="op">*</span>z) <span class="op">+</span> b </span>
<span id="cb32-9"><a href="#cb32-9" aria-hidden="true" tabindex="-1"></a>y_fft <span class="op">=</span> <span class="fu">abs</span>.(<span class="fu">fftshift</span>(<span class="fu">fft</span>(y)))</span>
<span id="cb32-10"><a href="#cb32-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-11"><a href="#cb32-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-12"><a href="#cb32-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-13"><a href="#cb32-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-14"><a href="#cb32-14" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(z, y, label<span class="op">=</span><span class="st">"data"</span>)</span>
<span id="cb32-15"><a href="#cb32-15" aria-hidden="true" tabindex="-1"></a><span class="fu">plot!</span>(z, y_fft, label<span class="op">=</span><span class="st">"fft"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<!--?xml version="1.0" encoding="utf-8"?-->
<svg xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" width="600" height="400" viewbox="0 0 2400 1600">
<defs>
  <clippath id="clip940">
    <rect x="0" y="0" width="2400" height="1600"></rect>
  </clippath>
</defs>
<path clip-path="url(#clip940)" d="M0 1600 L2400 1600 L2400 0 L0 0  Z" fill="#ffffff" fill-rule="evenodd" fill-opacity="1"></path>
<defs>
  <clippath id="clip941">
    <rect x="480" y="0" width="1681" height="1600"></rect>
  </clippath>
</defs>
<path clip-path="url(#clip940)" d="M169.121 1486.45 L2352.76 1486.45 L2352.76 47.2441 L169.121 47.2441  Z" fill="#ffffff" fill-rule="evenodd" fill-opacity="1"></path>
<defs>
  <clippath id="clip942">
    <rect x="169" y="47" width="2185" height="1440"></rect>
  </clippath>
</defs>
<polyline clip-path="url(#clip942)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="230.922,1486.45 230.922,47.2441 "></polyline>
<polyline clip-path="url(#clip942)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="745.93,1486.45 745.93,47.2441 "></polyline>
<polyline clip-path="url(#clip942)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="1260.94,1486.45 1260.94,47.2441 "></polyline>
<polyline clip-path="url(#clip942)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="1775.95,1486.45 1775.95,47.2441 "></polyline>
<polyline clip-path="url(#clip942)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="2290.95,1486.45 2290.95,47.2441 "></polyline>
<polyline clip-path="url(#clip942)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="169.121,1439.36 2352.76,1439.36 "></polyline>
<polyline clip-path="url(#clip942)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="169.121,1227.61 2352.76,1227.61 "></polyline>
<polyline clip-path="url(#clip942)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="169.121,1015.85 2352.76,1015.85 "></polyline>
<polyline clip-path="url(#clip942)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="169.121,804.099 2352.76,804.099 "></polyline>
<polyline clip-path="url(#clip942)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="169.121,592.345 2352.76,592.345 "></polyline>
<polyline clip-path="url(#clip942)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="169.121,380.59 2352.76,380.59 "></polyline>
<polyline clip-path="url(#clip942)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="169.121,168.836 2352.76,168.836 "></polyline>
<polyline clip-path="url(#clip940)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="169.121,1486.45 2352.76,1486.45 "></polyline>
<polyline clip-path="url(#clip940)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="230.922,1486.45 230.922,1467.55 "></polyline>
<polyline clip-path="url(#clip940)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="745.93,1486.45 745.93,1467.55 "></polyline>
<polyline clip-path="url(#clip940)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="1260.94,1486.45 1260.94,1467.55 "></polyline>
<polyline clip-path="url(#clip940)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="1775.95,1486.45 1775.95,1467.55 "></polyline>
<polyline clip-path="url(#clip940)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="2290.95,1486.45 2290.95,1467.55 "></polyline>
<path clip-path="url(#clip940)" d="M208.307 1517.37 Q204.696 1517.37 202.867 1520.93 Q201.061 1524.47 201.061 1531.6 Q201.061 1538.71 202.867 1542.27 Q204.696 1545.82 208.307 1545.82 Q211.941 1545.82 213.746 1542.27 Q215.575 1538.71 215.575 1531.6 Q215.575 1524.47 213.746 1520.93 Q211.941 1517.37 208.307 1517.37 M208.307 1513.66 Q214.117 1513.66 217.172 1518.27 Q220.251 1522.85 220.251 1531.6 Q220.251 1540.33 217.172 1544.94 Q214.117 1549.52 208.307 1549.52 Q202.497 1549.52 199.418 1544.94 Q196.362 1540.33 196.362 1531.6 Q196.362 1522.85 199.418 1518.27 Q202.497 1513.66 208.307 1513.66 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip940)" d="M228.469 1542.97 L233.353 1542.97 L233.353 1548.85 L228.469 1548.85 L228.469 1542.97 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip940)" d="M253.538 1517.37 Q249.927 1517.37 248.098 1520.93 Q246.293 1524.47 246.293 1531.6 Q246.293 1538.71 248.098 1542.27 Q249.927 1545.82 253.538 1545.82 Q257.172 1545.82 258.978 1542.27 Q260.806 1538.71 260.806 1531.6 Q260.806 1524.47 258.978 1520.93 Q257.172 1517.37 253.538 1517.37 M253.538 1513.66 Q259.348 1513.66 262.404 1518.27 Q265.482 1522.85 265.482 1531.6 Q265.482 1540.33 262.404 1544.94 Q259.348 1549.52 253.538 1549.52 Q247.728 1549.52 244.649 1544.94 Q241.594 1540.33 241.594 1531.6 Q241.594 1522.85 244.649 1518.27 Q247.728 1513.66 253.538 1513.66 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip940)" d="M717.667 1544.91 L733.986 1544.91 L733.986 1548.85 L712.042 1548.85 L712.042 1544.91 Q714.704 1542.16 719.287 1537.53 Q723.894 1532.88 725.074 1531.53 Q727.319 1529.01 728.199 1527.27 Q729.102 1525.51 729.102 1523.82 Q729.102 1521.07 727.157 1519.33 Q725.236 1517.6 722.134 1517.6 Q719.935 1517.6 717.482 1518.36 Q715.051 1519.13 712.273 1520.68 L712.273 1515.95 Q715.097 1514.82 717.551 1514.24 Q720.005 1513.66 722.042 1513.66 Q727.412 1513.66 730.606 1516.35 Q733.801 1519.03 733.801 1523.52 Q733.801 1525.65 732.991 1527.57 Q732.204 1529.47 730.097 1532.07 Q729.519 1532.74 726.417 1535.95 Q723.315 1539.15 717.667 1544.91 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip940)" d="M743.801 1542.97 L748.685 1542.97 L748.685 1548.85 L743.801 1548.85 L743.801 1542.97 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip940)" d="M758.916 1514.29 L777.273 1514.29 L777.273 1518.22 L763.199 1518.22 L763.199 1526.7 Q764.217 1526.35 765.236 1526.19 Q766.254 1526 767.273 1526 Q773.06 1526 776.44 1529.17 Q779.819 1532.34 779.819 1537.76 Q779.819 1543.34 776.347 1546.44 Q772.875 1549.52 766.555 1549.52 Q764.379 1549.52 762.111 1549.15 Q759.866 1548.78 757.458 1548.04 L757.458 1543.34 Q759.541 1544.47 761.764 1545.03 Q763.986 1545.58 766.463 1545.58 Q770.467 1545.58 772.805 1543.48 Q775.143 1541.37 775.143 1537.76 Q775.143 1534.15 772.805 1532.04 Q770.467 1529.94 766.463 1529.94 Q764.588 1529.94 762.713 1530.35 Q760.861 1530.77 758.916 1531.65 L758.916 1514.29 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip940)" d="M1228.1 1514.29 L1246.46 1514.29 L1246.46 1518.22 L1232.39 1518.22 L1232.39 1526.7 Q1233.4 1526.35 1234.42 1526.19 Q1235.44 1526 1236.46 1526 Q1242.25 1526 1245.63 1529.17 Q1249.01 1532.34 1249.01 1537.76 Q1249.01 1543.34 1245.53 1546.44 Q1242.06 1549.52 1235.74 1549.52 Q1233.57 1549.52 1231.3 1549.15 Q1229.05 1548.78 1226.64 1548.04 L1226.64 1543.34 Q1228.73 1544.47 1230.95 1545.03 Q1233.17 1545.58 1235.65 1545.58 Q1239.65 1545.58 1241.99 1543.48 Q1244.33 1541.37 1244.33 1537.76 Q1244.33 1534.15 1241.99 1532.04 Q1239.65 1529.94 1235.65 1529.94 Q1233.77 1529.94 1231.9 1530.35 Q1230.05 1530.77 1228.1 1531.65 L1228.1 1514.29 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip940)" d="M1258.22 1542.97 L1263.1 1542.97 L1263.1 1548.85 L1258.22 1548.85 L1258.22 1542.97 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip940)" d="M1283.29 1517.37 Q1279.68 1517.37 1277.85 1520.93 Q1276.04 1524.47 1276.04 1531.6 Q1276.04 1538.71 1277.85 1542.27 Q1279.68 1545.82 1283.29 1545.82 Q1286.92 1545.82 1288.73 1542.27 Q1290.56 1538.71 1290.56 1531.6 Q1290.56 1524.47 1288.73 1520.93 Q1286.92 1517.37 1283.29 1517.37 M1283.29 1513.66 Q1289.1 1513.66 1292.15 1518.27 Q1295.23 1522.85 1295.23 1531.6 Q1295.23 1540.33 1292.15 1544.94 Q1289.1 1549.52 1283.29 1549.52 Q1277.48 1549.52 1274.4 1544.94 Q1271.34 1540.33 1271.34 1531.6 Q1271.34 1522.85 1274.4 1518.27 Q1277.48 1513.66 1283.29 1513.66 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip940)" d="M1742.27 1514.29 L1764.49 1514.29 L1764.49 1516.28 L1751.94 1548.85 L1747.06 1548.85 L1758.86 1518.22 L1742.27 1518.22 L1742.27 1514.29 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip940)" d="M1773.61 1542.97 L1778.49 1542.97 L1778.49 1548.85 L1773.61 1548.85 L1773.61 1542.97 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip940)" d="M1788.72 1514.29 L1807.08 1514.29 L1807.08 1518.22 L1793.01 1518.22 L1793.01 1526.7 Q1794.03 1526.35 1795.04 1526.19 Q1796.06 1526 1797.08 1526 Q1802.87 1526 1806.25 1529.17 Q1809.63 1532.34 1809.63 1537.76 Q1809.63 1543.34 1806.15 1546.44 Q1802.68 1549.52 1796.36 1549.52 Q1794.19 1549.52 1791.92 1549.15 Q1789.67 1548.78 1787.27 1548.04 L1787.27 1543.34 Q1789.35 1544.47 1791.57 1545.03 Q1793.79 1545.58 1796.27 1545.58 Q1800.28 1545.58 1802.61 1543.48 Q1804.95 1541.37 1804.95 1537.76 Q1804.95 1534.15 1802.61 1532.04 Q1800.28 1529.94 1796.27 1529.94 Q1794.4 1529.94 1792.52 1530.35 Q1790.67 1530.77 1788.72 1531.65 L1788.72 1514.29 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip940)" d="M2243.03 1544.91 L2250.67 1544.91 L2250.67 1518.55 L2242.36 1520.21 L2242.36 1515.95 L2250.62 1514.29 L2255.3 1514.29 L2255.3 1544.91 L2262.93 1544.91 L2262.93 1548.85 L2243.03 1548.85 L2243.03 1544.91 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip940)" d="M2282.38 1517.37 Q2278.77 1517.37 2276.94 1520.93 Q2275.13 1524.47 2275.13 1531.6 Q2275.13 1538.71 2276.94 1542.27 Q2278.77 1545.82 2282.38 1545.82 Q2286.01 1545.82 2287.82 1542.27 Q2289.65 1538.71 2289.65 1531.6 Q2289.65 1524.47 2287.82 1520.93 Q2286.01 1517.37 2282.38 1517.37 M2282.38 1513.66 Q2288.19 1513.66 2291.24 1518.27 Q2294.32 1522.85 2294.32 1531.6 Q2294.32 1540.33 2291.24 1544.94 Q2288.19 1549.52 2282.38 1549.52 Q2276.57 1549.52 2273.49 1544.94 Q2270.43 1540.33 2270.43 1531.6 Q2270.43 1522.85 2273.49 1518.27 Q2276.57 1513.66 2282.38 1513.66 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip940)" d="M2302.54 1542.97 L2307.42 1542.97 L2307.42 1548.85 L2302.54 1548.85 L2302.54 1542.97 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip940)" d="M2327.61 1517.37 Q2324 1517.37 2322.17 1520.93 Q2320.36 1524.47 2320.36 1531.6 Q2320.36 1538.71 2322.17 1542.27 Q2324 1545.82 2327.61 1545.82 Q2331.24 1545.82 2333.05 1542.27 Q2334.88 1538.71 2334.88 1531.6 Q2334.88 1524.47 2333.05 1520.93 Q2331.24 1517.37 2327.61 1517.37 M2327.61 1513.66 Q2333.42 1513.66 2336.48 1518.27 Q2339.55 1522.85 2339.55 1531.6 Q2339.55 1540.33 2336.48 1544.94 Q2333.42 1549.52 2327.61 1549.52 Q2321.8 1549.52 2318.72 1544.94 Q2315.67 1540.33 2315.67 1531.6 Q2315.67 1522.85 2318.72 1518.27 Q2321.8 1513.66 2327.61 1513.66 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><polyline clip-path="url(#clip940)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="169.121,1486.45 169.121,47.2441 "></polyline>
<polyline clip-path="url(#clip940)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="169.121,1439.36 188.019,1439.36 "></polyline>
<polyline clip-path="url(#clip940)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="169.121,1227.61 188.019,1227.61 "></polyline>
<polyline clip-path="url(#clip940)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="169.121,1015.85 188.019,1015.85 "></polyline>
<polyline clip-path="url(#clip940)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="169.121,804.099 188.019,804.099 "></polyline>
<polyline clip-path="url(#clip940)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="169.121,592.345 188.019,592.345 "></polyline>
<polyline clip-path="url(#clip940)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="169.121,380.59 188.019,380.59 "></polyline>
<polyline clip-path="url(#clip940)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="169.121,168.836 188.019,168.836 "></polyline>
<path clip-path="url(#clip940)" d="M121.177 1425.16 Q117.566 1425.16 115.737 1428.73 Q113.932 1432.27 113.932 1439.4 Q113.932 1446.5 115.737 1450.07 Q117.566 1453.61 121.177 1453.61 Q124.811 1453.61 126.617 1450.07 Q128.445 1446.5 128.445 1439.4 Q128.445 1432.27 126.617 1428.73 Q124.811 1425.16 121.177 1425.16 M121.177 1421.46 Q126.987 1421.46 130.043 1426.06 Q133.121 1430.65 133.121 1439.4 Q133.121 1448.12 130.043 1452.73 Q126.987 1457.31 121.177 1457.31 Q115.367 1457.31 112.288 1452.73 Q109.233 1448.12 109.233 1439.4 Q109.233 1430.65 112.288 1426.06 Q115.367 1421.46 121.177 1421.46 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip940)" d="M85.0429 1240.95 L101.362 1240.95 L101.362 1244.89 L79.4179 1244.89 L79.4179 1240.95 Q82.0799 1238.2 86.6632 1233.57 Q91.2697 1228.92 92.4502 1227.57 Q94.6956 1225.05 95.5752 1223.31 Q96.478 1221.56 96.478 1219.87 Q96.478 1217.11 94.5336 1215.37 Q92.6123 1213.64 89.5104 1213.64 Q87.3114 1213.64 84.8577 1214.4 Q82.4271 1215.17 79.6494 1216.72 L79.6494 1212 Q82.4734 1210.86 84.9271 1210.28 Q87.3808 1209.7 89.4178 1209.7 Q94.7882 1209.7 97.9826 1212.39 Q101.177 1215.07 101.177 1219.56 Q101.177 1221.69 100.367 1223.62 Q99.5798 1225.51 97.4734 1228.11 Q96.8947 1228.78 93.7928 1232 Q90.691 1235.19 85.0429 1240.95 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip940)" d="M121.177 1213.41 Q117.566 1213.41 115.737 1216.97 Q113.932 1220.51 113.932 1227.64 Q113.932 1234.75 115.737 1238.31 Q117.566 1241.86 121.177 1241.86 Q124.811 1241.86 126.617 1238.31 Q128.445 1234.75 128.445 1227.64 Q128.445 1220.51 126.617 1216.97 Q124.811 1213.41 121.177 1213.41 M121.177 1209.7 Q126.987 1209.7 130.043 1214.31 Q133.121 1218.89 133.121 1227.64 Q133.121 1236.37 130.043 1240.98 Q126.987 1245.56 121.177 1245.56 Q115.367 1245.56 112.288 1240.98 Q109.233 1236.37 109.233 1227.64 Q109.233 1218.89 112.288 1214.31 Q115.367 1209.7 121.177 1209.7 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip940)" d="M93.8623 1002.65 L82.0568 1021.1 L93.8623 1021.1 L93.8623 1002.65 M92.6354 998.574 L98.515 998.574 L98.515 1021.1 L103.446 1021.1 L103.446 1024.99 L98.515 1024.99 L98.515 1033.13 L93.8623 1033.13 L93.8623 1024.99 L78.2605 1024.99 L78.2605 1020.47 L92.6354 998.574 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip940)" d="M121.177 1001.65 Q117.566 1001.65 115.737 1005.22 Q113.932 1008.76 113.932 1015.89 Q113.932 1023 115.737 1026.56 Q117.566 1030.1 121.177 1030.1 Q124.811 1030.1 126.617 1026.56 Q128.445 1023 128.445 1015.89 Q128.445 1008.76 126.617 1005.22 Q124.811 1001.65 121.177 1001.65 M121.177 997.949 Q126.987 997.949 130.043 1002.56 Q133.121 1007.14 133.121 1015.89 Q133.121 1024.62 130.043 1029.22 Q126.987 1033.81 121.177 1033.81 Q115.367 1033.81 112.288 1029.22 Q109.233 1024.62 109.233 1015.89 Q109.233 1007.14 112.288 1002.56 Q115.367 997.949 121.177 997.949 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip940)" d="M91.5938 802.236 Q88.4456 802.236 86.5938 804.389 Q84.7651 806.542 84.7651 810.292 Q84.7651 814.018 86.5938 816.194 Q88.4456 818.347 91.5938 818.347 Q94.7419 818.347 96.5706 816.194 Q98.4224 814.018 98.4224 810.292 Q98.4224 806.542 96.5706 804.389 Q94.7419 802.236 91.5938 802.236 M100.876 787.583 L100.876 791.843 Q99.1169 791.009 97.3113 790.569 Q95.5289 790.13 93.7697 790.13 Q89.1401 790.13 86.6864 793.255 Q84.2558 796.38 83.9086 802.699 Q85.2743 800.685 87.3345 799.62 Q89.3947 798.532 91.8715 798.532 Q97.0798 798.532 100.089 801.704 Q103.121 804.852 103.121 810.292 Q103.121 815.616 99.9733 818.833 Q96.8252 822.051 91.5938 822.051 Q85.5984 822.051 82.4271 817.467 Q79.2559 812.861 79.2559 804.134 Q79.2559 795.94 83.1447 791.079 Q87.0336 786.194 93.5845 786.194 Q95.3437 786.194 97.1261 786.542 Q98.9317 786.889 100.876 787.583 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip940)" d="M121.177 789.898 Q117.566 789.898 115.737 793.463 Q113.932 797.005 113.932 804.134 Q113.932 811.241 115.737 814.805 Q117.566 818.347 121.177 818.347 Q124.811 818.347 126.617 814.805 Q128.445 811.241 128.445 804.134 Q128.445 797.005 126.617 793.463 Q124.811 789.898 121.177 789.898 M121.177 786.194 Q126.987 786.194 130.043 790.801 Q133.121 795.384 133.121 804.134 Q133.121 812.861 130.043 817.467 Q126.987 822.051 121.177 822.051 Q115.367 822.051 112.288 817.467 Q109.233 812.861 109.233 804.134 Q109.233 795.384 112.288 790.801 Q115.367 786.194 121.177 786.194 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip940)" d="M91.0151 593.213 Q87.6817 593.213 85.7605 594.995 Q83.8623 596.778 83.8623 599.903 Q83.8623 603.028 85.7605 604.81 Q87.6817 606.592 91.0151 606.592 Q94.3484 606.592 96.2697 604.81 Q98.1909 603.004 98.1909 599.903 Q98.1909 596.778 96.2697 594.995 Q94.3715 593.213 91.0151 593.213 M86.3392 591.222 Q83.3299 590.481 81.6401 588.421 Q79.9735 586.361 79.9735 583.398 Q79.9735 579.255 82.9133 576.847 Q85.8762 574.44 91.0151 574.44 Q96.1771 574.44 99.1169 576.847 Q102.057 579.255 102.057 583.398 Q102.057 586.361 100.367 588.421 Q98.7002 590.481 95.7141 591.222 Q99.0937 592.009 100.969 594.301 Q102.867 596.592 102.867 599.903 Q102.867 604.926 99.7882 607.611 Q96.7326 610.296 91.0151 610.296 Q85.2975 610.296 82.2188 607.611 Q79.1633 604.926 79.1633 599.903 Q79.1633 596.592 81.0614 594.301 Q82.9595 592.009 86.3392 591.222 M84.6262 583.838 Q84.6262 586.523 86.2929 588.028 Q87.9827 589.532 91.0151 589.532 Q94.0243 589.532 95.7141 588.028 Q97.4271 586.523 97.4271 583.838 Q97.4271 581.153 95.7141 579.648 Q94.0243 578.144 91.0151 578.144 Q87.9827 578.144 86.2929 579.648 Q84.6262 581.153 84.6262 583.838 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip940)" d="M121.177 578.144 Q117.566 578.144 115.737 581.708 Q113.932 585.25 113.932 592.38 Q113.932 599.486 115.737 603.051 Q117.566 606.592 121.177 606.592 Q124.811 606.592 126.617 603.051 Q128.445 599.486 128.445 592.38 Q128.445 585.25 126.617 581.708 Q124.811 578.144 121.177 578.144 M121.177 574.44 Q126.987 574.44 130.043 579.046 Q133.121 583.63 133.121 592.38 Q133.121 601.106 130.043 605.713 Q126.987 610.296 121.177 610.296 Q115.367 610.296 112.288 605.713 Q109.233 601.106 109.233 592.38 Q109.233 583.63 112.288 579.046 Q115.367 574.44 121.177 574.44 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip940)" d="M51.6634 393.935 L59.3023 393.935 L59.3023 367.569 L50.9921 369.236 L50.9921 364.977 L59.256 363.31 L63.9319 363.31 L63.9319 393.935 L71.5707 393.935 L71.5707 397.87 L51.6634 397.87 L51.6634 393.935 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip940)" d="M91.0151 366.389 Q87.404 366.389 85.5753 369.954 Q83.7697 373.495 83.7697 380.625 Q83.7697 387.731 85.5753 391.296 Q87.404 394.838 91.0151 394.838 Q94.6493 394.838 96.4548 391.296 Q98.2835 387.731 98.2835 380.625 Q98.2835 373.495 96.4548 369.954 Q94.6493 366.389 91.0151 366.389 M91.0151 362.685 Q96.8252 362.685 99.8808 367.292 Q102.959 371.875 102.959 380.625 Q102.959 389.352 99.8808 393.958 Q96.8252 398.542 91.0151 398.542 Q85.2049 398.542 82.1262 393.958 Q79.0707 389.352 79.0707 380.625 Q79.0707 371.875 82.1262 367.292 Q85.2049 362.685 91.0151 362.685 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip940)" d="M121.177 366.389 Q117.566 366.389 115.737 369.954 Q113.932 373.495 113.932 380.625 Q113.932 387.731 115.737 391.296 Q117.566 394.838 121.177 394.838 Q124.811 394.838 126.617 391.296 Q128.445 387.731 128.445 380.625 Q128.445 373.495 126.617 369.954 Q124.811 366.389 121.177 366.389 M121.177 362.685 Q126.987 362.685 130.043 367.292 Q133.121 371.875 133.121 380.625 Q133.121 389.352 130.043 393.958 Q126.987 398.542 121.177 398.542 Q115.367 398.542 112.288 393.958 Q109.233 389.352 109.233 380.625 Q109.233 371.875 112.288 367.292 Q115.367 362.685 121.177 362.685 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip940)" d="M51.6634 182.18 L59.3023 182.18 L59.3023 155.815 L50.9921 157.481 L50.9921 153.222 L59.256 151.556 L63.9319 151.556 L63.9319 182.18 L71.5707 182.18 L71.5707 186.116 L51.6634 186.116 L51.6634 182.18 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip940)" d="M85.0429 182.18 L101.362 182.18 L101.362 186.116 L79.4179 186.116 L79.4179 182.18 Q82.0799 179.426 86.6632 174.796 Q91.2697 170.143 92.4502 168.801 Q94.6956 166.278 95.5752 164.542 Q96.478 162.782 96.478 161.093 Q96.478 158.338 94.5336 156.602 Q92.6123 154.866 89.5104 154.866 Q87.3114 154.866 84.8577 155.63 Q82.4271 156.394 79.6494 157.944 L79.6494 153.222 Q82.4734 152.088 84.9271 151.509 Q87.3808 150.931 89.4178 150.931 Q94.7882 150.931 97.9826 153.616 Q101.177 156.301 101.177 160.792 Q101.177 162.921 100.367 164.843 Q99.5798 166.741 97.4734 169.333 Q96.8947 170.005 93.7928 173.222 Q90.691 176.417 85.0429 182.18 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip940)" d="M121.177 154.634 Q117.566 154.634 115.737 158.199 Q113.932 161.741 113.932 168.87 Q113.932 175.977 115.737 179.542 Q117.566 183.083 121.177 183.083 Q124.811 183.083 126.617 179.542 Q128.445 175.977 128.445 168.87 Q128.445 161.741 126.617 158.199 Q124.811 154.634 121.177 154.634 M121.177 150.931 Q126.987 150.931 130.043 155.537 Q133.121 160.12 133.121 168.87 Q133.121 177.597 130.043 182.204 Q126.987 186.787 121.177 186.787 Q115.367 186.787 112.288 182.204 Q109.233 177.597 109.233 168.87 Q109.233 160.12 112.288 155.537 Q115.367 150.931 121.177 150.931 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><polyline clip-path="url(#clip942)" style="stroke:#009af9; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="230.922,1435.13 239.001,1427.65 247.079,1424.54 255.158,1427.62 263.237,1435.08 271.315,1442.57 279.394,1445.72 287.472,1442.67 295.551,1435.22 303.629,1427.71 311.708,1424.54 319.786,1427.55 327.865,1434.99 335.944,1442.51 344.022,1445.71 352.101,1442.74 360.179,1435.31 368.258,1427.78 376.336,1424.54 384.415,1427.49 392.493,1434.9 400.572,1442.44 408.651,1445.71 416.729,1442.8 424.808,1435.4 432.886,1427.85 440.965,1424.54 449.043,1427.43 457.122,1434.81 465.201,1442.38 473.279,1445.71 481.358,1442.86 489.436,1435.5 497.515,1427.91 505.593,1424.55 513.672,1427.36 521.75,1434.71 529.829,1442.31 537.908,1445.71 545.986,1442.92 554.065,1435.59 562.143,1427.98 570.222,1424.55 578.3,1427.3 586.379,1434.62 594.457,1442.24 602.536,1445.7 610.615,1442.99 618.693,1435.68 626.772,1428.05 634.85,1424.56 642.929,1427.24 651.007,1434.53 659.086,1442.17 667.164,1445.7 675.243,1443.05 683.322,1435.77 691.4,1428.12 699.479,1424.56 707.557,1427.18 715.636,1434.44 723.714,1442.1 731.793,1445.69 739.872,1443.11 747.95,1435.86 756.029,1428.19 764.107,1424.57 772.186,1427.12 780.264,1434.35 788.343,1442.03 796.421,1445.69 804.5,1443.17 812.579,1435.95 820.657,1428.26 828.736,1424.57 836.814,1427.06 844.893,1434.26 852.971,1441.96 861.05,1445.68 869.128,1443.23 877.207,1436.05 885.286,1428.33 893.364,1424.58 901.443,1427 909.521,1434.17 917.6,1441.89 925.678,1445.67 933.757,1443.29 941.836,1436.14 949.914,1428.4 957.993,1424.59 966.071,1426.94 974.15,1434.07 982.228,1441.82 990.307,1445.66 998.385,1443.35 1006.46,1436.23 1014.54,1428.47 1022.62,1424.6 1030.7,1426.88 1038.78,1433.98 1046.86,1441.75 1054.94,1445.65 1063.01,1443.4 1071.09,1436.32 1079.17,1428.54 1087.25,1424.61 1095.33,1426.83 1103.41,1433.89 1111.49,1441.68 1119.56,1445.64 1127.64,1443.46 1135.72,1436.41 1143.8,1428.61 1151.88,1424.62 1159.96,1426.77 1168.04,1433.8 1176.11,1441.61 1184.19,1445.63 1192.27,1443.52 1200.35,1436.5 1208.43,1428.69 1216.51,1424.63 1224.59,1426.71 1232.66,1433.71 1240.74,1441.53 1248.82,1445.62 1256.9,1443.57 1264.98,1436.59 1273.06,1428.76 1281.14,1424.65 1289.21,1426.66 1297.29,1433.62 1305.37,1441.46 1313.45,1445.6 1321.53,1443.63 1329.61,1436.68 1337.68,1428.83 1345.76,1424.66 1353.84,1426.6 1361.92,1433.53 1370,1441.39 1378.08,1445.59 1386.16,1443.68 1394.23,1436.77 1402.31,1428.91 1410.39,1424.67 1418.47,1426.55 1426.55,1433.44 1434.63,1441.31 1442.71,1445.58 1450.78,1443.74 1458.86,1436.87 1466.94,1428.98 1475.02,1424.69 1483.1,1426.49 1491.18,1433.35 1499.26,1441.24 1507.33,1445.56 1515.41,1443.79 1523.49,1436.96 1531.57,1429.06 1539.65,1424.7 1547.73,1426.44 1555.81,1433.26 1563.88,1441.16 1571.96,1445.54 1580.04,1443.84 1588.12,1437.05 1596.2,1429.13 1604.28,1424.72 1612.36,1426.39 1620.43,1433.16 1628.51,1441.09 1636.59,1445.53 1644.67,1443.89 1652.75,1437.14 1660.83,1429.21 1668.91,1424.74 1676.98,1426.34 1685.06,1433.07 1693.14,1441.01 1701.22,1445.51 1709.3,1443.94 1717.38,1437.23 1725.46,1429.28 1733.53,1424.76 1741.61,1426.29 1749.69,1432.98 1757.77,1440.93 1765.85,1445.49 1773.93,1443.99 1782.01,1437.32 1790.08,1429.36 1798.16,1424.77 1806.24,1426.24 1814.32,1432.89 1822.4,1440.86 1830.48,1445.47 1838.56,1444.04 1846.63,1437.41 1854.71,1429.44 1862.79,1424.79 1870.87,1426.19 1878.95,1432.8 1887.03,1440.78 1895.11,1445.45 1903.18,1444.09 1911.26,1437.5 1919.34,1429.52 1927.42,1424.81 1935.5,1426.14 1943.58,1432.72 1951.66,1440.7 1959.73,1445.43 1967.81,1444.14 1975.89,1437.59 1983.97,1429.59 1992.05,1424.83 2000.13,1426.09 2008.21,1432.63 2016.28,1440.62 2024.36,1445.41 2032.44,1444.19 2040.52,1437.67 2048.6,1429.67 2056.68,1424.86 2064.76,1426.04 2072.83,1432.54 2080.91,1440.55 2088.99,1445.39 2097.07,1444.24 2105.15,1437.76 2113.23,1429.75 2121.31,1424.88 2129.38,1426 2137.46,1432.45 2145.54,1440.47 2153.62,1445.37 2161.7,1444.28 2169.78,1437.85 2177.86,1429.83 2185.93,1424.9 2194.01,1425.95 2202.09,1432.36 2210.17,1440.39 2218.25,1445.34 2226.33,1444.33 2234.41,1437.94 2242.48,1429.91 2250.56,1424.93 2258.64,1425.9 2266.72,1432.27 2274.8,1440.31 2282.88,1445.32 2290.95,1444.37 "></polyline>
<polyline clip-path="url(#clip942)" style="stroke:#e26f46; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="230.922,1438 239.001,1438 247.079,1438 255.158,1437.99 263.237,1437.99 271.315,1437.99 279.394,1437.99 287.472,1437.99 295.551,1437.99 303.629,1437.98 311.708,1437.98 319.786,1437.98 327.865,1437.98 335.944,1437.97 344.022,1437.97 352.101,1437.96 360.179,1437.96 368.258,1437.95 376.336,1437.95 384.415,1437.94 392.493,1437.94 400.572,1437.93 408.651,1437.92 416.729,1437.92 424.808,1437.91 432.886,1437.9 440.965,1437.89 449.043,1437.88 457.122,1437.87 465.201,1437.86 473.279,1437.85 481.358,1437.84 489.436,1437.83 497.515,1437.82 505.593,1437.81 513.672,1437.79 521.75,1437.78 529.829,1437.77 537.908,1437.75 545.986,1437.74 554.065,1437.72 562.143,1437.7 570.222,1437.69 578.3,1437.67 586.379,1437.65 594.457,1437.63 602.536,1437.61 610.615,1437.58 618.693,1437.56 626.772,1437.54 634.85,1437.51 642.929,1437.48 651.007,1437.45 659.086,1437.42 667.164,1437.39 675.243,1437.36 683.322,1437.33 691.4,1437.29 699.479,1437.25 707.557,1437.21 715.636,1437.17 723.714,1437.12 731.793,1437.07 739.872,1437.02 747.95,1436.96 756.029,1436.9 764.107,1436.84 772.186,1436.77 780.264,1436.7 788.343,1436.62 796.421,1436.54 804.5,1436.45 812.579,1436.35 820.657,1436.24 828.736,1436.13 836.814,1436 844.893,1435.86 852.971,1435.7 861.05,1435.53 869.128,1435.34 877.207,1435.12 885.286,1434.87 893.364,1434.59 901.443,1434.27 909.521,1433.89 917.6,1433.44 925.678,1432.9 933.757,1432.25 941.836,1431.43 949.914,1430.37 957.993,1428.97 966.071,1427.02 974.15,1424.09 982.228,1419.25 990.307,1409.66 998.385,1381.69 1006.46,87.9763 1014.54,1377.42 1022.62,1409.35 1030.7,1419.67 1038.78,1424.77 1046.86,1427.81 1054.94,1429.83 1063.01,1431.27 1071.09,1432.34 1079.17,1433.17 1087.25,1433.83 1095.33,1434.38 1103.41,1434.82 1111.49,1435.2 1119.56,1435.52 1127.64,1435.8 1135.72,1436.04 1143.8,1436.24 1151.88,1436.42 1159.96,1436.58 1168.04,1436.72 1176.11,1436.85 1184.19,1436.96 1192.27,1437.05 1200.35,1437.13 1208.43,1437.2 1216.51,1437.26 1224.59,1437.31 1232.66,1437.35 1240.74,1437.38 1248.82,1437.4 1256.9,1437.42 1264.98,353.239 1273.06,1437.42 1281.14,1437.4 1289.21,1437.38 1297.29,1437.35 1305.37,1437.31 1313.45,1437.26 1321.53,1437.2 1329.61,1437.13 1337.68,1437.05 1345.76,1436.96 1353.84,1436.85 1361.92,1436.72 1370,1436.58 1378.08,1436.42 1386.16,1436.24 1394.23,1436.04 1402.31,1435.8 1410.39,1435.52 1418.47,1435.2 1426.55,1434.82 1434.63,1434.38 1442.71,1433.83 1450.78,1433.17 1458.86,1432.34 1466.94,1431.27 1475.02,1429.83 1483.1,1427.81 1491.18,1424.77 1499.26,1419.67 1507.33,1409.35 1515.41,1377.42 1523.49,87.9763 1531.57,1381.69 1539.65,1409.66 1547.73,1419.25 1555.81,1424.09 1563.88,1427.02 1571.96,1428.97 1580.04,1430.37 1588.12,1431.43 1596.2,1432.25 1604.28,1432.9 1612.36,1433.44 1620.43,1433.89 1628.51,1434.27 1636.59,1434.59 1644.67,1434.87 1652.75,1435.12 1660.83,1435.34 1668.91,1435.53 1676.98,1435.7 1685.06,1435.86 1693.14,1436 1701.22,1436.13 1709.3,1436.24 1717.38,1436.35 1725.46,1436.45 1733.53,1436.54 1741.61,1436.62 1749.69,1436.7 1757.77,1436.77 1765.85,1436.84 1773.93,1436.9 1782.01,1436.96 1790.08,1437.02 1798.16,1437.07 1806.24,1437.12 1814.32,1437.17 1822.4,1437.21 1830.48,1437.25 1838.56,1437.29 1846.63,1437.33 1854.71,1437.36 1862.79,1437.39 1870.87,1437.42 1878.95,1437.45 1887.03,1437.48 1895.11,1437.51 1903.18,1437.54 1911.26,1437.56 1919.34,1437.58 1927.42,1437.61 1935.5,1437.63 1943.58,1437.65 1951.66,1437.67 1959.73,1437.69 1967.81,1437.7 1975.89,1437.72 1983.97,1437.74 1992.05,1437.75 2000.13,1437.77 2008.21,1437.78 2016.28,1437.79 2024.36,1437.81 2032.44,1437.82 2040.52,1437.83 2048.6,1437.84 2056.68,1437.85 2064.76,1437.86 2072.83,1437.87 2080.91,1437.88 2088.99,1437.89 2097.07,1437.9 2105.15,1437.91 2113.23,1437.92 2121.31,1437.92 2129.38,1437.93 2137.46,1437.94 2145.54,1437.94 2153.62,1437.95 2161.7,1437.95 2169.78,1437.96 2177.86,1437.96 2185.93,1437.97 2194.01,1437.97 2202.09,1437.98 2210.17,1437.98 2218.25,1437.98 2226.33,1437.98 2234.41,1437.99 2242.48,1437.99 2250.56,1437.99 2258.64,1437.99 2266.72,1437.99 2274.8,1437.99 2282.88,1438 2290.95,1438 "></polyline>
<path clip-path="url(#clip940)" d="M1961.74 250.738 L2279.97 250.738 L2279.97 95.2176 L1961.74 95.2176  Z" fill="#ffffff" fill-rule="evenodd" fill-opacity="1"></path>
<polyline clip-path="url(#clip940)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="1961.74,250.738 2279.97,250.738 2279.97,95.2176 1961.74,95.2176 1961.74,250.738 "></polyline>
<polyline clip-path="url(#clip940)" style="stroke:#009af9; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="1986.01,147.058 2131.58,147.058 "></polyline>
<path clip-path="url(#clip940)" d="M2174.76 142.347 L2174.76 128.319 L2179.02 128.319 L2179.02 164.338 L2174.76 164.338 L2174.76 160.449 Q2173.41 162.763 2171.35 163.898 Q2169.32 165.009 2166.45 165.009 Q2161.75 165.009 2158.78 161.259 Q2155.84 157.509 2155.84 151.398 Q2155.84 145.287 2158.78 141.537 Q2161.75 137.787 2166.45 137.787 Q2169.32 137.787 2171.35 138.921 Q2173.41 140.032 2174.76 142.347 M2160.24 151.398 Q2160.24 156.097 2162.16 158.782 Q2164.11 161.444 2167.49 161.444 Q2170.87 161.444 2172.81 158.782 Q2174.76 156.097 2174.76 151.398 Q2174.76 146.699 2172.81 144.037 Q2170.87 141.352 2167.49 141.352 Q2164.11 141.352 2162.16 144.037 Q2160.24 146.699 2160.24 151.398 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip940)" d="M2199.57 151.305 Q2194.41 151.305 2192.42 152.486 Q2190.43 153.666 2190.43 156.514 Q2190.43 158.782 2191.91 160.125 Q2193.41 161.444 2195.98 161.444 Q2199.53 161.444 2201.65 158.944 Q2203.81 156.421 2203.81 152.254 L2203.81 151.305 L2199.57 151.305 M2208.07 149.546 L2208.07 164.338 L2203.81 164.338 L2203.81 160.402 Q2202.35 162.763 2200.17 163.898 Q2198 165.009 2194.85 165.009 Q2190.87 165.009 2188.51 162.787 Q2186.17 160.541 2186.17 156.791 Q2186.17 152.416 2189.09 150.194 Q2192.03 147.972 2197.84 147.972 L2203.81 147.972 L2203.81 147.555 Q2203.81 144.615 2201.86 143.018 Q2199.94 141.398 2196.45 141.398 Q2194.22 141.398 2192.12 141.93 Q2190.01 142.463 2188.07 143.527 L2188.07 139.592 Q2190.4 138.69 2192.6 138.25 Q2194.8 137.787 2196.89 137.787 Q2202.51 137.787 2205.29 140.703 Q2208.07 143.62 2208.07 149.546 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip940)" d="M2221.05 131.051 L2221.05 138.412 L2229.83 138.412 L2229.83 141.722 L2221.05 141.722 L2221.05 155.796 Q2221.05 158.967 2221.91 159.87 Q2222.79 160.773 2225.45 160.773 L2229.83 160.773 L2229.83 164.338 L2225.45 164.338 Q2220.52 164.338 2218.65 162.509 Q2216.77 160.657 2216.77 155.796 L2216.77 141.722 L2213.65 141.722 L2213.65 138.412 L2216.77 138.412 L2216.77 131.051 L2221.05 131.051 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip940)" d="M2247.21 151.305 Q2242.05 151.305 2240.06 152.486 Q2238.07 153.666 2238.07 156.514 Q2238.07 158.782 2239.55 160.125 Q2241.05 161.444 2243.62 161.444 Q2247.16 161.444 2249.29 158.944 Q2251.45 156.421 2251.45 152.254 L2251.45 151.305 L2247.21 151.305 M2255.71 149.546 L2255.71 164.338 L2251.45 164.338 L2251.45 160.402 Q2249.99 162.763 2247.81 163.898 Q2245.64 165.009 2242.49 165.009 Q2238.51 165.009 2236.15 162.787 Q2233.81 160.541 2233.81 156.791 Q2233.81 152.416 2236.72 150.194 Q2239.66 147.972 2245.47 147.972 L2251.45 147.972 L2251.45 147.555 Q2251.45 144.615 2249.5 143.018 Q2247.58 141.398 2244.09 141.398 Q2241.86 141.398 2239.76 141.93 Q2237.65 142.463 2235.71 143.527 L2235.71 139.592 Q2238.04 138.69 2240.24 138.25 Q2242.44 137.787 2244.52 137.787 Q2250.15 137.787 2252.93 140.703 Q2255.71 143.62 2255.71 149.546 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><polyline clip-path="url(#clip940)" style="stroke:#e26f46; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="1986.01,198.898 2131.58,198.898 "></polyline>
<path clip-path="url(#clip940)" d="M2172.35 180.159 L2172.35 183.701 L2168.28 183.701 Q2165.98 183.701 2165.08 184.627 Q2164.2 185.553 2164.2 187.96 L2164.2 190.252 L2171.22 190.252 L2171.22 193.562 L2164.2 193.562 L2164.2 216.178 L2159.92 216.178 L2159.92 193.562 L2155.84 193.562 L2155.84 190.252 L2159.92 190.252 L2159.92 188.446 Q2159.92 184.118 2161.93 182.15 Q2163.95 180.159 2168.32 180.159 L2172.35 180.159 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip940)" d="M2189.04 180.159 L2189.04 183.701 L2184.97 183.701 Q2182.67 183.701 2181.77 184.627 Q2180.89 185.553 2180.89 187.96 L2180.89 190.252 L2187.9 190.252 L2187.9 193.562 L2180.89 193.562 L2180.89 216.178 L2176.61 216.178 L2176.61 193.562 L2172.53 193.562 L2172.53 190.252 L2176.61 190.252 L2176.61 188.446 Q2176.61 184.118 2178.62 182.15 Q2180.64 180.159 2185.01 180.159 L2189.04 180.159 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip940)" d="M2195.98 182.891 L2195.98 190.252 L2204.76 190.252 L2204.76 193.562 L2195.98 193.562 L2195.98 207.636 Q2195.98 210.807 2196.84 211.71 Q2197.72 212.613 2200.38 212.613 L2204.76 212.613 L2204.76 216.178 L2200.38 216.178 Q2195.45 216.178 2193.58 214.349 Q2191.7 212.497 2191.7 207.636 L2191.7 193.562 L2188.58 193.562 L2188.58 190.252 L2191.7 190.252 L2191.7 182.891 L2195.98 182.891 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path></svg>
</div>
</div>
<div id="cell-24" class="cell" data-execution_count="19">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> <span class="fu">Model</span>(Ipopt.Optimizer)</span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set_silent</span>(model)</span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a>ConstraintFunc <span class="op">=</span> <span class="fu">MinimizingFunc</span>(z, y_fft)</span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-5"><a href="#cb33-5" aria-hidden="true" tabindex="-1"></a>q <span class="op">=</span> <span class="pp">@variable</span>(model, start<span class="op">=</span>m)</span>
<span id="cb33-6"><a href="#cb33-6" aria-hidden="true" tabindex="-1"></a>p <span class="op">=</span> <span class="pp">@variable</span>(model, start<span class="op">=</span>b)</span>
<span id="cb33-7"><a href="#cb33-7" aria-hidden="true" tabindex="-1"></a><span class="co"># ams = @expression(model, ConstraintFunc(φ))</span></span>
<span id="cb33-8"><a href="#cb33-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-9"><a href="#cb33-9" aria-hidden="true" tabindex="-1"></a><span class="co"># @constraint(model, ams[1] == ams[2])</span></span>
<span id="cb33-10"><a href="#cb33-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-11"><a href="#cb33-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-12"><a href="#cb33-12" aria-hidden="true" tabindex="-1"></a><span class="pp">@objective</span>(model, Min, <span class="fu">ConstraintFunc</span>(q,p))</span>
<span id="cb33-13"><a href="#cb33-13" aria-hidden="true" tabindex="-1"></a><span class="fu">optimize!</span>(model)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-error">
<pre><code>UndefVarError: UndefVarError: `Model` not defined in `Main`
Suggestion: check for spelling errors or missing imports.
UndefVarError: `Model` not defined in `Main`

Suggestion: check for spelling errors or missing imports.



Stacktrace:

 [1] top-level scope

   @ ~/Desktop/julia_functions/jl_notebook_cell_df34fa98e69747e1a8f8a730347b8e2f_X22sZmlsZQ==.jl:1</code></pre>
</div>
</div>
<div id="cell-25" class="cell" data-execution_count="20">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a>q_sol <span class="op">=</span> <span class="fu">value</span>(q)</span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a>p_sol <span class="op">=</span> <span class="fu">value</span>(p)</span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a><span class="fu">println</span>(<span class="st">"Solution:"</span>)</span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a><span class="fu">println</span>(<span class="st">"q = "</span>, q_sol)</span>
<span id="cb35-5"><a href="#cb35-5" aria-hidden="true" tabindex="-1"></a><span class="fu">println</span>(<span class="st">"p = "</span>, p_sol)</span>
<span id="cb35-6"><a href="#cb35-6" aria-hidden="true" tabindex="-1"></a>model_fit <span class="op">=</span> @. <span class="fu">sin</span>(q_sol<span class="op">*</span>z) <span class="op">+</span> <span class="fl">.1</span></span>
<span id="cb35-7"><a href="#cb35-7" aria-hidden="true" tabindex="-1"></a>model_fit_fft <span class="op">=</span> <span class="fu">abs</span>.(<span class="fu">fftshift</span>(<span class="fu">fft</span>(model_fit)))</span>
<span id="cb35-8"><a href="#cb35-8" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(z, model_fit_fft, label<span class="op">=</span><span class="st">"model fit"</span>, linestyle<span class="op">=:</span>dash)</span>
<span id="cb35-9"><a href="#cb35-9" aria-hidden="true" tabindex="-1"></a><span class="fu">plot!</span>(z, y_fft, label<span class="op">=</span><span class="st">"fft"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-error">
<pre><code>UndefVarError: UndefVarError: `value` not defined in `Main`
Suggestion: check for spelling errors or missing imports.
UndefVarError: `value` not defined in `Main`

Suggestion: check for spelling errors or missing imports.



Stacktrace:

 [1] top-level scope

   @ ~/Desktop/julia_functions/jl_notebook_cell_df34fa98e69747e1a8f8a730347b8e2f_X23sZmlsZQ==.jl:1</code></pre>
</div>
</div>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
        const codeEl = trigger.previousElementSibling.cloneNode(true);
        for (const childEl of codeEl.children) {
          if (isCodeAnnotation(childEl)) {
            childEl.remove();
          }
        }
        return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
</div> <!-- /content -->




</body></html>